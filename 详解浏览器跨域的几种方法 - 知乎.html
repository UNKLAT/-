<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/159060398 -->
<html lang="zh" data-hairline="true" data-theme="light" data-react-helmet="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>详解浏览器跨域的几种方法 - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-react-helmet="true" name="keywords" content="网页浏览器,跨域,前端开发"><meta data-react-helmet="true" name="description" content="摘要：本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。1 前言在WEB前端开发中，我们经常会碰到“跨域”问题，最常见的就是浏览器在A域名页…"><meta data-react-helmet="true" property="og:title" content="详解浏览器跨域的几种方法"><meta data-react-helmet="true" property="og:url" content="https://zhuanlan.zhihu.com/p/159060398"><meta data-react-helmet="true" property="og:description" content="摘要：本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。1 前言在WEB前端开发中，我们经常会碰到“跨域”问题，最常见的就是浏览器在A域名页…"><meta data-react-helmet="true" property="og:image" content=""><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="og:site_name" content="知乎专栏"><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.67c7b278.png"><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.67c7b278.png" sizes="152x152"><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.b3e6278d.png" sizes="120x120"><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7a750095.png" sizes="76x76"><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.a4a761d4.png" sizes="60x60"><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/static/favicon.ico"><link rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/static/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><style>
.u-safeAreaInset-top {
  height: constant(safe-area-inset-top) !important;
  height: env(safe-area-inset-top) !important;
  
}
.u-safeAreaInset-bottom {
  height: constant(safe-area-inset-bottom) !important;
  height: env(safe-area-inset-bottom) !important;
  
}
</style><link href="./详解浏览器跨域的几种方法 - 知乎_files/column.app.216a26f4.460cc34c16d4f1ad7006.css" rel="stylesheet"><script type="text/javascript" async="" src="./详解浏览器跨域的几种方法 - 知乎_files/analytics.js.下载" nonce=""></script><script defer="" crossorigin="anonymous" src="./详解浏览器跨域的几种方法 - 知乎_files/init.js.下载" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;783-3112a2fe&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrors&quot;:[&quot;origin message&quot;,&quot;Network request failed&quot;,&quot;Loading chunk&quot;,&quot;这个系统不支持该功能。&quot;,&quot;Can&#39;t find variable: webkit&quot;,&quot;Can&#39;t find variable: $&quot;,&quot;内存不足&quot;,&quot;out of memory&quot;,&quot;DOM Exception 18&quot;,&quot;The operation is insecure&quot;,&quot;[object Event]&quot;,&quot;[object FileError]&quot;,&quot;[object DOMError]&quot;,&quot;[object Object]&quot;,&quot;拒绝访问。&quot;,&quot;Maximum call stack size exceeded&quot;,&quot;UploadError&quot;,&quot;无法 fetch&quot;,&quot;draft-js&quot;,&quot;缺少 JavaScript 对象&quot;,&quot;componentWillEnter&quot;,&quot;componentWillLeave&quot;,&quot;componentWillAppear&quot;,&quot;getInlineStyleAt&quot;,&quot;getCharacterList&quot;],&quot;whitelistUrls&quot;:[&quot;static.zhihu.com&quot;]}"></script><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="n99yhz">.css-n99yhz{box-sizing:border-box;margin:0;min-width:0;color:#175199;display:inline-block;margin-left:.3em;}</style><style data-emotion-css="18biwo">.css-18biwo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="1ifz0go">.css-1ifz0go{overflow:visible!important;}</style><script charset="utf-8" src="./详解浏览器跨域的几种方法 - 知乎_files/column.zswsdid.1809e060ecdbfaf101da.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解浏览器跨域的几种方法 - 知乎_files/column.user-hover-card.216a26f4.7da9107a14dfae975315.css"><script charset="utf-8" src="./详解浏览器跨域的几种方法 - 知乎_files/column.user-hover-card.dd35915275d593309bc5.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解浏览器跨域的几种方法 - 知乎_files/column.Labels.216a26f4.127af84d6bdb9827e439.css"><script charset="utf-8" src="./详解浏览器跨域的几种方法 - 知乎_files/column.Labels.debb3e16fe2440e9a960.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解浏览器跨域的几种方法 - 知乎_files/column.modals.216a26f4.5c913f5c7a4bfd8ab947.css"><script charset="utf-8" src="./详解浏览器跨域的几种方法 - 知乎_files/column.modals.030c450b6fb877721f25.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解浏览器跨域的几种方法 - 知乎_files/column.comments-modals.216a26f4.6d6460557c91a7e3f461.css"><script charset="utf-8" src="./详解浏览器跨域的几种方法 - 知乎_files/column.comments-modals.99126b3f10fd49902231.js.下载"></script><style data-emotion="css"></style><link rel="stylesheet" type="text/css" href="./详解浏览器跨域的几种方法 - 知乎_files/column.richinput.216a26f4.ea29f2e8f601a9f98625.css"><script charset="utf-8" src="./详解浏览器跨域的几种方法 - 知乎_files/column.richinput.1c53ba81f7db6e4f0a5f.js.下载"></script></head><body class="WhiteBg-body" data-react-helmet="class"><img hidden="" src="./详解浏览器跨域的几种方法 - 知乎_files/logo.f6eef033.png"><div id="root"><div class="App"><div class="LoadingBar"></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;&quot;}" data-zop="{&quot;authorName&quot;:&quot;华为云开发者社区&quot;,&quot;itemId&quot;:159060398,&quot;title&quot;:&quot;详解浏览器跨域的几种方法&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;159060398&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader" style=""><div class="ColumnPageHeader-content"><a class="ZhihuLogoLink" href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 200 91" fill="#0084FF" width="64" height="30"><path d="M53.29 80.035l7.32.002 2.41 8.24 13.128-8.24h15.477v-67.98H53.29v67.978zm7.79-60.598h22.756v53.22h-8.73l-8.718 5.473-1.587-5.46-3.72-.012v-53.22zM46.818 43.162h-16.35c.545-8.467.687-16.12.687-22.955h15.987s.615-7.05-2.68-6.97H16.807c1.09-4.1 2.46-8.332 4.1-12.708 0 0-7.523 0-10.085 6.74-1.06 2.78-4.128 13.48-9.592 24.41 1.84-.2 7.927-.37 11.512-6.94.66-1.84.785-2.08 1.605-4.54h9.02c0 3.28-.374 20.9-.526 22.95H6.51c-3.67 0-4.863 7.38-4.863 7.38H22.14C20.765 66.11 13.385 79.24 0 89.62c6.403 1.828 12.784-.29 15.937-3.094 0 0 7.182-6.53 11.12-21.64L43.92 85.18s2.473-8.402-.388-12.496c-2.37-2.788-8.768-10.33-11.496-13.064l-4.57 3.627c1.363-4.368 2.183-8.61 2.46-12.71H49.19s-.027-7.38-2.372-7.38zm128.752-.502c6.51-8.013 14.054-18.302 14.054-18.302s-5.827-4.625-8.556-1.27c-1.874 2.548-11.51 15.063-11.51 15.063l6.012 4.51zm-46.903-18.462c-2.814-2.577-8.096.667-8.096.667s12.35 17.2 12.85 17.953l6.08-4.29s-8.02-11.752-10.83-14.33zM199.99 46.5c-6.18 0-40.908.292-40.953.292v-31.56c1.503 0 3.882-.124 7.14-.376 12.773-.753 21.914-1.25 27.427-1.504 0 0 3.817-8.496-.185-10.45-.96-.37-7.24 1.43-7.24 1.43s-51.63 5.153-72.61 5.64c.5 2.756 2.38 5.336 4.93 6.11 4.16 1.087 7.09.53 15.36.277 7.76-.5 13.65-.76 17.66-.76v31.19h-41.71s.88 6.97 7.97 7.14h33.73v22.16c0 4.364-3.498 6.87-7.65 6.6-4.4.034-8.15-.36-13.027-.566.623 1.24 1.977 4.496 6.035 6.824 3.087 1.502 5.054 2.053 8.13 2.053 9.237 0 14.27-5.4 14.027-14.16V53.93h38.235c3.026 0 2.72-7.432 2.72-7.432z" fill-rule="evenodd"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="https://www.zhihu.com/column/c_1016019161834774528">程序员之家</a></div></div><div class="ColumnPageHeader-Button"><button type="button" class="Button ColumnPageHeader-WriteButton Button--blue"><svg class="Zi Zi--EditSurround" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M18.453 7.992l-1.833-1.65.964-.978a1.223 1.223 0 0 1 1.73-.012l.005.006a1.24 1.24 0 0 1 .007 1.748l-.873.886zm-1.178 1.194l-5.578 5.66-1.935.697a.393.393 0 0 1-.504-.504l.697-1.935 5.488-5.567 1.832 1.65zM7.58 5.848l5.654.006-1.539 1.991-3.666.012A1.02 1.02 0 0 0 7 8.868v7.993c0 .558.46 1.01 1.029 1.01l7.941-.01c.568 0 1.03-.453 1.03-1.012v-4.061l2-1.442v6.002c0 1.397-1.2 2.501-2.62 2.501H7.574C6.153 19.85 5 18.717 5 17.32V8.35c0-1.397 1.16-2.502 2.58-2.502z"></path></svg>写文章</button></div></div></div></div></div><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">详解浏览器跨域的几种方法</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="华为云开发者社区"><meta itemprop="image" content="https://pic1.zhimg.com/v2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/hua-wei-yun-ji-zhu-zhai-ji-di"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover8-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover8-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/org/hua-wei-yun-ji-zhu-zhai-ji-di"><img class="Avatar Avatar--round AuthorInfo-avatar" width="38" height="38" src="./详解浏览器跨域的几种方法 - 知乎_files/v2-31e47f21cb0d425f7dfdf801537157de_xs.jpg" srcset="https://pic1.zhimg.com/v2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b 2x" alt="华为云开发者社区"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover9-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover9-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/org/hua-wei-yun-ji-zhu-zhai-ji-di">华为云开发者社区</a></div></div><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-n99yhz" aria-label="已认证的官方帐号" data-tooltip="已认证的官方帐号"><span class="css-18biwo">​<svg viewBox="0 0 24 24" class="css-1ifz0go" width="18" height="18"><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#FFFFFF" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="#0084FF"></path><svg class="Zi Zi--Check" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z" fill-rule="evenodd"></path></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">已认证的官方帐号</div></div></div></div></div></div><div><span class="Voters"><button type="button" class="Button Button--plain">10 人<!-- -->赞同了该文章</button></span></div></header><div class="Post-RichTextContainer"><div class="RichText ztext Post-RichText"><blockquote><b>摘要：</b>本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。</blockquote><h2><b>1 前言</b></h2><p>在WEB前端开发中，我们经常会碰到“跨域”问题，最常见的就是浏览器在A域名页面发送B域名的请求时会被限制。跨域问题涉及到WEB网页安全性问题，使用不当会造成用户隐私泄露风险，但有时业务上又需要进行跨域请求。如何正确的使用跨域功能，既能满足业务需求，又能够满足安全性要求，显得尤为重要。</p><p>本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。</p><h2><b>2 背景知识介绍</b></h2><p><b>2.1 同源政策</b></p><p>1995年，同源政策由 Netscape 公司引入浏览器。目前，所有浏览器都实行这个政策。</p><p>最初，它的含义是指，A 网页设置的 Cookie，B 网页不能打开，除非这两个网页“同源”。所谓“同源”指的是“三个相同”：</p><ul><li>协议相同</li><li>域名相同</li><li>端口相同</li></ul><p>同源政策的目的，是为了保证用户信息的安全，防止恶意的网站窃取数据。</p><p><b>设想这样一种情况：</b></p><p>A 网站是一家银行，用户登录以后，A 网站在用户的机器上设置了一个 Cookie，包含了一些隐私信息（比如存款总额）。用户离开 A 网站以后，又去访问 B 网站，如果没有同源限制，B 网站可以读取 A 网站的 Cookie，那么隐私信息就会泄漏。更可怕的是，Cookie 往往用来保存用户的登录状态，如果用户没有退出登录，其他网站就可以冒充用户，为所欲为。因为浏览器同时还规定，提交表单不受同源政策的限制。由此可见，同源政策是必需的，否则 Cookie 可以共享，互联网就毫无安全可言了。</p><p>当前，如果非同源，共有三种行为受到限制：</p><ul><li>Cookie、LocalStorage 和 IndexDB 无法读取</li><li>DOM 无法获得</li><li>AJAX 请求不能发送</li></ul><p><b>2.2 为什么要有跨域限制</b></p><p><b>Ajax 的同源策略</b>主要是为了防止 <b>CSRF（跨站请求伪造）</b> 攻击，如果没有 AJAX 同源策略，相当危险，我们发起的每一次 HTTP 请求都会带上请求地址对应的 cookie，那么可以做如下攻击：</p><ul><li>用户登录了自己的银行页面 <a href="https://link.zhihu.com/?target=http%3A//mybank.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">mybank.com</span><span class="invisible"></span></a>，<a href="https://link.zhihu.com/?target=http%3A//mybank.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">mybank.com</span><span class="invisible"></span></a>向用户的cookie中添加用户标识。</li><li>用户浏览了恶意页面 <a href="https://link.zhihu.com/?target=http%3A//evil.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">evil.com</span><span class="invisible"></span></a>。执行了页面中的恶意AJAX请求代码。</li><li><a href="https://link.zhihu.com/?target=http%3A//evil.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">evil.com</span><span class="invisible"></span></a>向<a href="https://link.zhihu.com/?target=http%3A//mybank.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">mybank.com</span><span class="invisible"></span></a>发起AJAX HTTP请求，请求会默认把<a href="https://link.zhihu.com/?target=http%3A//mybank.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">mybank.com</span><span class="invisible"></span></a>对应cookie也同时发送过去。</li><li>银行页面从发送的cookie中提取用户标识，验证用户无误，response中返回请求数据。此时数据就泄露了。</li><li>而且由于Ajax在后台执行，用户无法感知这一过程。</li></ul><p><b>DOM同源策略</b>也一样，如果 iframe 之间可以跨域访问，可以这样攻击：</p><ul><li>做一个假网站，里面用iframe嵌套一个银行网站 <a href="https://link.zhihu.com/?target=http%3A//mybank.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">mybank.com</span><span class="invisible"></span></a>。</li><li>把iframe宽高啥的调整到页面全部，这样用户进来除了域名，别的部分和银行的网站没有任何差别。</li><li>这时如果用户输入账号密码，我们的主网站可以跨域访问到<a href="https://link.zhihu.com/?target=http%3A//mybank.com" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">mybank.com</span><span class="invisible"></span></a>的dom节点，就可以拿到用户的输入了，那么就完成了一次攻击。</li></ul><p> 所以有了跨域访问限制之后，我们才能够安全的上网。</p><h2><b>3 浏览器跨域的解决方案</b></h2><p><b>3.1 CORS标准</b></p><p>CORS 是一个 W3C 标准，全称是跨域资源共享（CORSs-origin resource sharing），它允许浏览器向跨源服务器，发出XMLHttpRequest请求。</p><p><b>其实，准确的来说，跨域机制是阻止了数据的跨域获取，不是阻止请求发送。</b></p><p>CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。</p><p><a href="https://link.zhihu.com/?target=https%3A//caniuse.com/%23search%3Dcors" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">https://</span><span class="visible">caniuse.com/#</span><span class="invisible">search=cors</span><span class="ellipsis"></span></a></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-eeca312dea6ba174b340ea2f329fa871_b.jpg" data-caption="" data-size="normal" data-rawwidth="489" data-rawheight="371" class="origin_image zh-lightbox-thumb" width="489" data-original="https://pic2.zhimg.com/v2-eeca312dea6ba174b340ea2f329fa871_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-eeca312dea6ba174b340ea2f329fa871_720w.jpg" data-caption="" data-size="normal" data-rawwidth="489" data-rawheight="371" class="origin_image zh-lightbox-thumb lazy" width="489" data-original="https://pic2.zhimg.com/v2-eeca312dea6ba174b340ea2f329fa871_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-eeca312dea6ba174b340ea2f329fa871_b.jpg" data-lazy-status="ok"></figure><p>整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。</p><p>因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨域通信。</p><p><b>3.2 CORS跨域判定的总体流程</b></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-1338484aef123b761da2c3880531d317_b.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="463" class="origin_image zh-lightbox-thumb" width="643" data-original="https://pic1.zhimg.com/v2-1338484aef123b761da2c3880531d317_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-1338484aef123b761da2c3880531d317_720w.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="463" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://pic1.zhimg.com/v2-1338484aef123b761da2c3880531d317_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-1338484aef123b761da2c3880531d317_b.jpg" data-lazy-status="ok"></figure><p>如图所示，跨域的判定流程为：</p><ul><li>网页上的JS代码，从浏览器上发送XMLHttpRequest请求到服务端</li><li>如果该请求为<b>简单请求</b>，浏览器会直接发送实际请求到服务端，浏览器会根据服务端的响应，判断该请求是否可以跨域：</li></ul><p>    （1）如果不能跨域，浏览器会报错，阻止JS代码进一步执行；</p><p>    （2）如果能够跨域，则JS能正常处理响应，进行后续业务流程</p><ul><li>如果该请求为<b>非简单请求</b>，浏览器会先发送一个预检请求(preflight)，方法为OPTIONS，然后针对服务器的响应，做上述跟简单请求一样相同的判断：</li></ul><p>   （1）如果不能跨域，则实际请求不会发送</p><p>   （2）如果能够跨域，则实际请求会进行发送，进行后续业务处理</p><p><b>值得说明的是，浏览器在跨域的情况下，请求都会发送出去</b>，但是对于响应会判断是否满足跨域条件，如果不满足，则报错，阻止JS后续的执行流程，例如读取响应数据等。也就是说，<b>跨域机制主要是阻止数据的跨域获取，不是阻止请求的发送</b>。</p><p><b>3.3 简单请求</b></p><p>实际上浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。</p><p>只要同时满足以下条件，就属于简单请求，<b>一般来说，只需要满足前两个即可</b>：</p><ul><li>请求方法是如下三种方法之一：GET、POST、HEAD</li><li>HTTP消息头不超过如下几个字段：</li></ul><p>   Accept</p><p>   Accept-Language</p><p>  Content-Language</p><p>  Last-Event-ID</p><p>  Content-Type：只限于三个值：application/x-www-form-urlencoded、multipart/form-data、text/plain</p><ul><li>请求中的任意XMLHttpRequestUpload 对象均没有注册任何事件**器</li><li>XMLHttpRequestUpload 对象可以使用 XMLHttpRequest.upload 属性访问。请求中没有使用 ReadableStream 对象</li></ul><p>对于简单请求，浏览器会直接发起CORS请求，将实际请求发给服务器，服务器返回响应给浏览器，同时在响应头域中携带CORS相关头域，供浏览器进行跨域判断。</p><p><b>3.4 非简单请求</b></p><p>非简单请求时指那些对服务器有特殊要求的请求，比如请求方法是 PUT或 DELETE，或者 Content-Type 的类型是 application/json。简而言之，不是简单请求的HTTP请求，都是非简单请求。</p><p>非简单请求的 CORS 请求，会在正式通信之前，使用 OPTIONS 方法发起一个预检（preflight）请求到服务器，浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些 HTTP方法和头信息字段。只有得到肯定答复，浏览器才会发出正式的 XMLHttpRequest 请求，否则就报错。</p><p><b>3.5 CORS相关头域</b></p><p>那么，无论是简单请求，还是非简单请求，浏览器都会对响应头域中的CORS相关字段进行判断，CORS的常见字段有如下几个：</p><p><b>3.5.1 Access-Control-Allow-Origin(必选)</b></p><p><b>涉及简单Http请求、非简单Http请求</b></p><p><b>含义</b>：允许的域名，只能填 *（通配符）或者单域名</p><p><b>举例</b>：</p><p>从<a href="https://link.zhihu.com/?target=https%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">https://www.huaweicloud.com</a>网页，发送<a href="https://link.zhihu.com/?target=https%3A//portal.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">https://portal.huaweicloud.com</a>请求，如果服务器响应头域中没有填写Access-Control-Allow-Origin，浏览器会报错：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-755134dd6b401b6b37b3f983d10e2e75_b.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="92" class="origin_image zh-lightbox-thumb" width="643" data-original="https://pic3.zhimg.com/v2-755134dd6b401b6b37b3f983d10e2e75_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-755134dd6b401b6b37b3f983d10e2e75_720w.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="92" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://pic3.zhimg.com/v2-755134dd6b401b6b37b3f983d10e2e75_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-755134dd6b401b6b37b3f983d10e2e75_b.jpg" data-lazy-status="ok"></figure><p>或者取值不为<a href="https://link.zhihu.com/?target=https%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">https://www.huaweicloud.com</a>，浏览器也会报错：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-58dd302c79d76be292cb29dc5453a3a5_b.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="94" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic2.zhimg.com/v2-58dd302c79d76be292cb29dc5453a3a5_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-58dd302c79d76be292cb29dc5453a3a5_720w.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="94" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic2.zhimg.com/v2-58dd302c79d76be292cb29dc5453a3a5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-58dd302c79d76be292cb29dc5453a3a5_b.jpg" data-lazy-status="ok"></figure><p>填写为*或者<a href="https://link.zhihu.com/?target=https%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">https://www.huaweicloud.com</a>，则不会报错：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-f6ec80b05fa4182632ce9c2e42b06fc2_b.jpg" data-caption="" data-size="normal" data-rawwidth="583" data-rawheight="216" class="origin_image zh-lightbox-thumb" width="583" data-original="https://pic1.zhimg.com/v2-f6ec80b05fa4182632ce9c2e42b06fc2_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-f6ec80b05fa4182632ce9c2e42b06fc2_720w.jpg" data-caption="" data-size="normal" data-rawwidth="583" data-rawheight="216" class="origin_image zh-lightbox-thumb lazy" width="583" data-original="https://pic1.zhimg.com/v2-f6ec80b05fa4182632ce9c2e42b06fc2_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-f6ec80b05fa4182632ce9c2e42b06fc2_b.jpg" data-lazy-status="ok"></figure><figure data-size="normal"><noscript><img src="https://picb.zhimg.com/v2-24146168d66ee16ad3987823a571c812_b.jpg" data-caption="" data-size="normal" data-rawwidth="522" data-rawheight="245" class="origin_image zh-lightbox-thumb" width="522" data-original="https://picb.zhimg.com/v2-24146168d66ee16ad3987823a571c812_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-24146168d66ee16ad3987823a571c812_720w.jpg" data-caption="" data-size="normal" data-rawwidth="522" data-rawheight="245" class="origin_image zh-lightbox-thumb lazy" width="522" data-original="https://picb.zhimg.com/v2-24146168d66ee16ad3987823a571c812_r.jpg" data-actualsrc="https://picb.zhimg.com/v2-24146168d66ee16ad3987823a571c812_b.jpg" data-lazy-status="ok"></figure><p><b>3.5.2 Access-Control-Allow-Credentials(可选)</b></p><p><b>涉及简单Http请求、非简单Http请求</b></p><p><b>含义</b>：表示是否允许发送Cookie，只有一个可选值：true（必为小写）。如果不包含cookies，请略去该项，而不是填写false。这一项与 XmlHttpRequest 对象当中的 withCredentials 属性应保持一致，即 withCredentials 为true时该项也为true；withCredentials 为false时，省略该项不写。反之则导致请求失败。</p><p><b>举例</b>：</p><p>当XmlHttpRequest中设置了withCredentials为true，如果服务器响应里没有Access-Control-Allow-Credentials字段，则浏览器会报错：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-e1988ad7dadef9d7a27da7121e4a1cf5_b.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="115" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic4.zhimg.com/v2-e1988ad7dadef9d7a27da7121e4a1cf5_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-e1988ad7dadef9d7a27da7121e4a1cf5_720w.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="115" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic4.zhimg.com/v2-e1988ad7dadef9d7a27da7121e4a1cf5_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-e1988ad7dadef9d7a27da7121e4a1cf5_b.jpg" data-lazy-status="ok"></figure><p>特别的，当XmlHttpRequest中设置了withCredentials为true时，还要求Access-Control-Allow-Origin字段不能为通配符*，其实这也好理解，因为设置了withCredentials，表示允许跨域发送Cookie，如果Origin允许为*的话，安全性就会大大降低了，很容易构造跨站攻击：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-f9fa52686c3265bc8ad5ba9ca9516e13_b.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="121" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic1.zhimg.com/v2-f9fa52686c3265bc8ad5ba9ca9516e13_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-f9fa52686c3265bc8ad5ba9ca9516e13_720w.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="121" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic1.zhimg.com/v2-f9fa52686c3265bc8ad5ba9ca9516e13_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-f9fa52686c3265bc8ad5ba9ca9516e13_b.jpg" data-lazy-status="ok"></figure><p><b>3.5.3 Access-Control-Expose-Headers(可选)</b></p><p><b>涉及简单Http请求、非简单Http请求</b></p><p><b>含义</b>：CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。</p><p><b>举例</b>：</p><p>在JS代码中，通过XMLHttpRequest对象来获取响应中的wise_traceid头域，如：</p><p>xhr. getResponseHeader("wise_traceid")</p><p>如果在服务器响应中，没有携带Access-Control-Expose-Headers或者Access-Control-Expose-Headers的值不包含wise_traceid，则浏览器会报错，JS拿到的值也是null：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-c31b10c8c7743cb2a09a5172e93f6d4d_b.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="65" class="origin_image zh-lightbox-thumb" width="643" data-original="https://pic2.zhimg.com/v2-c31b10c8c7743cb2a09a5172e93f6d4d_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-c31b10c8c7743cb2a09a5172e93f6d4d_720w.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="65" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://pic2.zhimg.com/v2-c31b10c8c7743cb2a09a5172e93f6d4d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-c31b10c8c7743cb2a09a5172e93f6d4d_b.jpg" data-lazy-status="ok"></figure><p><b>3.5.4 预检请求preflight</b></p><p>根据上述分析，如果是非简单Http请求，浏览器会先发送一个预检请求，要求服务器进行确认。预检请求使用的方法是OPTIONS，表示这个请求是用来询问的，头信息里面，关键字段是Origin，表示请求来自哪个源。</p><p>除了Origin字段，"预检"请求的头信息包括两个特殊字段：</p><ul><li><b>Access-Control-Request-Method</b></li></ul><p>该字段是必须的，用来列出浏览器的CORS请求会用到哪些HTTP方法，如PUT：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-8d320e9285261aed66748738874322e1_b.jpg" data-caption="" data-size="normal" data-rawwidth="578" data-rawheight="249" class="origin_image zh-lightbox-thumb" width="578" data-original="https://pic3.zhimg.com/v2-8d320e9285261aed66748738874322e1_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-8d320e9285261aed66748738874322e1_720w.jpg" data-caption="" data-size="normal" data-rawwidth="578" data-rawheight="249" class="origin_image zh-lightbox-thumb lazy" width="578" data-original="https://pic3.zhimg.com/v2-8d320e9285261aed66748738874322e1_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-8d320e9285261aed66748738874322e1_b.jpg" data-lazy-status="ok"></figure><ul><li><b>Access-Control-Request-Headers</b></li></ul><p>该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，当使用了简单请求那5个字段之外的字段，浏览器会在OPTIONS请求头域中，指定 Access-Control-Request-Headers的取值，如：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-cbd08931b1d010b3890c27b84b50e4af_b.jpg" data-caption="" data-size="normal" data-rawwidth="587" data-rawheight="210" class="origin_image zh-lightbox-thumb" width="587" data-original="https://pic4.zhimg.com/v2-cbd08931b1d010b3890c27b84b50e4af_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-cbd08931b1d010b3890c27b84b50e4af_720w.jpg" data-caption="" data-size="normal" data-rawwidth="587" data-rawheight="210" class="origin_image zh-lightbox-thumb lazy" width="587" data-original="https://pic4.zhimg.com/v2-cbd08931b1d010b3890c27b84b50e4af_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-cbd08931b1d010b3890c27b84b50e4af_b.jpg" data-lazy-status="ok"></figure><p><b>如果预检请求的响应，浏览器没有校验通过，不允许跨域，浏览器除了会在控制台报错之外，后续实际请求也不会发送了。</b></p><p><b>3.5.5 Access-Control-Allow-Methods(必选)</b></p><p><b>涉及非简单Http请求</b></p><p><b>含义</b>：允许跨域请求的 http 方法（如<b>POST</b>、<b>GET</b>、<b>OPTIONS、PUT、DELETE</b>），该字段是对于预检请求中的Access-Control-Request-Method的回复。</p><p><b>备注</b>：对于简单请求的GET、POST方法，该字段不是必选的，浏览器会默认允许这两个方法进行跨域</p><p><b>举例</b>：</p><p>从<a href="https://link.zhihu.com/?target=https%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">https://www.huaweicloud.com</a>，跨域访问<a href="https://link.zhihu.com/?target=https%3A//portal.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">https://portal.huaweicloud.com</a>，HTTP方法为POST，如果服务器响应里没有Access-Control-Allow-Methods，跨域请求能够成功：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-d4d8159011f85aac0beb516c8c5a91f7_b.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="396" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic3.zhimg.com/v2-d4d8159011f85aac0beb516c8c5a91f7_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-d4d8159011f85aac0beb516c8c5a91f7_720w.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="396" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic3.zhimg.com/v2-d4d8159011f85aac0beb516c8c5a91f7_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-d4d8159011f85aac0beb516c8c5a91f7_b.jpg" data-lazy-status="ok"></figure><p>如果服务器响应里Access-Control-Allow-Methods不包含POST，跨域请求也能成功：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f5e622ed0433d59162ff09f535ce1d86_b.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="394" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic3.zhimg.com/v2-f5e622ed0433d59162ff09f535ce1d86_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-f5e622ed0433d59162ff09f535ce1d86_720w.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="394" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic3.zhimg.com/v2-f5e622ed0433d59162ff09f535ce1d86_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f5e622ed0433d59162ff09f535ce1d86_b.jpg" data-lazy-status="ok"></figure><p>如果请求为PUT方法，但响应里没有携带Access-Control-Allow-Methods或者取值不包含PUT，浏览器会报错：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-723fb0839cf562082e3a039864098173_b.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="92" class="origin_image zh-lightbox-thumb" width="643" data-original="https://pic4.zhimg.com/v2-723fb0839cf562082e3a039864098173_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-723fb0839cf562082e3a039864098173_720w.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="92" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://pic4.zhimg.com/v2-723fb0839cf562082e3a039864098173_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-723fb0839cf562082e3a039864098173_b.jpg" data-lazy-status="ok"></figure><p><b>3.5.6 Access-Control-Allow-Headers(可选)</b></p><p><b>涉及非简单Http请求</b></p><p><b>含义</b>：该字段指定了跨域允许设置的非简单Http请求头（5个简单Http请求头之外的头域），（当预请求中包含 Access-Control-Request-Headers 时必须包含）– 这是对预请求当中 Access-Control-Request-Headers 的回复，和上面一样是以逗号分隔的列表，可以返回所有支持的头部。</p><p><b>举例</b>：</p><p>如果在XMLHttpRequest中设置了wise_groupid字段，而服务器响应中，没有Access-Control-Allow-Headers头域，或者Access-Control-Allow-Headers头域的值不包含wise_groupid，则浏览器会报错：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-785c7dd100b69337bf323b112abb753b_b.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="93" class="origin_image zh-lightbox-thumb" width="643" data-original="https://pic3.zhimg.com/v2-785c7dd100b69337bf323b112abb753b_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-785c7dd100b69337bf323b112abb753b_720w.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="93" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://pic3.zhimg.com/v2-785c7dd100b69337bf323b112abb753b_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-785c7dd100b69337bf323b112abb753b_b.jpg" data-lazy-status="ok"></figure><p><b>3.5.7 Access-Control-Max-Age(可选)</b></p><p><b>涉及简单Http请求、非简单Http请求</b></p><p><b>含义</b>：用来指定本次预检请求的有效期，单位为秒。例如，Access-Control-Max-Age被设置为1728000，表示有效期是20天（1728000秒），即允许缓存该条回应1728000秒（即20天），在此期间，不用发出另一条预检请求。</p><h2><b>4 其它跨域手段</b></h2><p><b>4.1 JSONP跨域</b></p><p>在HTML文档中，有一个script标签，该标签一般会引用当前HTML文档需要加载的js脚本，例如：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-f74a4832f87fa94733abbbdaecf3bc05_b.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="22" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic2.zhimg.com/v2-f74a4832f87fa94733abbbdaecf3bc05_r.jpg"/></noscript><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-f74a4832f87fa94733abbbdaecf3bc05_720w.jpg" data-caption="" data-size="normal" data-rawwidth="642" data-rawheight="22" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic2.zhimg.com/v2-f74a4832f87fa94733abbbdaecf3bc05_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-f74a4832f87fa94733abbbdaecf3bc05_b.jpg" data-lazy-status="ok"></figure><p>浏览器在加载HTML文档时，会顺序加载script标签中src的地址，这种加载是可以跨域加载的，浏览器不会阻止跨域的js加载。</p><p>此外，还有img等标签，可以跨域加载。</p><p>而 JSONP正是利用了script/img等标签能够跨域加载，来实现跨域请求的功能，如下代码所示：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-6384a977980e126910a6e7b6f8948ff4_b.jpg" data-caption="" data-size="normal" data-rawwidth="545" data-rawheight="135" class="origin_image zh-lightbox-thumb" width="545" data-original="https://pic2.zhimg.com/v2-6384a977980e126910a6e7b6f8948ff4_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;545&#39; height=&#39;135&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="545" data-rawheight="135" class="origin_image zh-lightbox-thumb lazy" width="545" data-original="https://pic2.zhimg.com/v2-6384a977980e126910a6e7b6f8948ff4_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-6384a977980e126910a6e7b6f8948ff4_b.jpg"></figure><p>代码先定义一个全局函数，然后把这个函数名通过callback参数添加到script标签的src，script的src就是需要跨域的请求，然后这个请求返回可执行的JS文本：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-5b0f3cc62bb7fb539d80ce3a001f2a04_b.jpg" data-caption="" data-size="normal" data-rawwidth="545" data-rawheight="52" class="origin_image zh-lightbox-thumb" width="545" data-original="https://pic2.zhimg.com/v2-5b0f3cc62bb7fb539d80ce3a001f2a04_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;545&#39; height=&#39;52&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="545" data-rawheight="52" class="origin_image zh-lightbox-thumb lazy" width="545" data-original="https://pic2.zhimg.com/v2-5b0f3cc62bb7fb539d80ce3a001f2a04_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-5b0f3cc62bb7fb539d80ce3a001f2a04_b.jpg"></figure><p>由于它是一个js，并且已经定义了upldateList函数，所以能正常执行，并且跨域的数据通过传参得到。这就是JSONP的原理。</p><p>如下图所示，服务器返回了响应之后，js方法updateList就可以获取到响应内容，打印在控制台：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-957d057bb700d036af6f07daaa7a4e5e_b.jpg" data-caption="" data-size="normal" data-rawwidth="471" data-rawheight="101" class="origin_image zh-lightbox-thumb" width="471" data-original="https://pic3.zhimg.com/v2-957d057bb700d036af6f07daaa7a4e5e_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;471&#39; height=&#39;101&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="471" data-rawheight="101" class="origin_image zh-lightbox-thumb lazy" width="471" data-original="https://pic3.zhimg.com/v2-957d057bb700d036af6f07daaa7a4e5e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-957d057bb700d036af6f07daaa7a4e5e_b.jpg"></figure><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-fd95c434824c299fe5c80328cd92dcbf_b.jpg" data-caption="" data-size="normal" data-rawwidth="331" data-rawheight="75" class="content_image" width="331"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;331&#39; height=&#39;75&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="331" data-rawheight="75" class="content_image lazy" width="331" data-actualsrc="https://pic4.zhimg.com/v2-fd95c434824c299fe5c80328cd92dcbf_b.jpg"></figure><p>JSONP方式跨域访问的时候，还会携带域名的Cookie：</p><figure data-size="normal"><noscript><img src="https://picb.zhimg.com/v2-318b4f983a2f9cb615509fac47c759da_b.jpg" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="181" class="origin_image zh-lightbox-thumb" width="643" data-original="https://picb.zhimg.com/v2-318b4f983a2f9cb615509fac47c759da_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;643&#39; height=&#39;181&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="643" data-rawheight="181" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://picb.zhimg.com/v2-318b4f983a2f9cb615509fac47c759da_r.jpg" data-actualsrc="https://picb.zhimg.com/v2-318b4f983a2f9cb615509fac47c759da_b.jpg"></figure><p>从上面可以看到，JSONP方式跨域，会不受同源政策影响，并且会携带跨域域名的Cookie，同样也会存在安全风险。</p><p>由于JSONP是利用script/img等标签来实现跨域，而浏览器加载这些标签，使用的是GET方法，这就要求业务对于一些重要的请求，不能够使用GET方法提交数据，必须要使用POST方法，这样就无法利用JSONP进行跨域请求了。</p><p><b>4.2 服务端转发</b></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-20fd19e07a8c16e3c90c586c74e8e0aa_b.jpg" data-caption="" data-size="normal" data-rawwidth="603" data-rawheight="272" class="origin_image zh-lightbox-thumb" width="603" data-original="https://pic3.zhimg.com/v2-20fd19e07a8c16e3c90c586c74e8e0aa_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;603&#39; height=&#39;272&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="603" data-rawheight="272" class="origin_image zh-lightbox-thumb lazy" width="603" data-original="https://pic3.zhimg.com/v2-20fd19e07a8c16e3c90c586c74e8e0aa_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-20fd19e07a8c16e3c90c586c74e8e0aa_b.jpg"></figure><p>如上图所示，服务端转发实现跨域访问的基本原理是，将访问B域名的请求，通过访问A域名，由A服务器转发给B服务器：</p><p>举例：</p><p>在<a href="https://link.zhihu.com/?target=https%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer">https://www.huaweicloud.com</a>页面上，想要访问<a href="https://link.zhihu.com/?target=https%3A//portal.huaweicloud.com/v1/template" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">portal.huaweicloud.com/</span><span class="invisible">v1/template</span><span class="ellipsis"></span></a>接口，那么可以通过如下手段实现跨域：</p><ul><li>页面上调用<a href="https://link.zhihu.com/?target=https%3A//www.huaweicloud.com/portal/v1/template" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">huaweicloud.com/portal/</span><span class="invisible">v1/template</span><span class="ellipsis"></span></a>接口</li><li><a href="https://link.zhihu.com/?target=http%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer">www.huaweicloud.com</a>服务器，对于/portal开头的请求，统一去掉portal路径，转发给portal.huaweicloud.com服务器，相当于<a href="https://link.zhihu.com/?target=http%3A//www.huaweicloud.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer">www.huaweicloud.com</a>服务器做了反向代理</li></ul><p>但是使用该方法，会导致无法发送<a href="https://link.zhihu.com/?target=http%3A//portal.huaweicloud.com" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">portal.huaweicloud.com</span><span class="invisible"></span></a>域名下的cookie，因此应用场景有限。</p><h2><b>5 扩展</b></h2><p><b>5.1 为什么要区分简单请求和非简单请求？</b></p><p>按照上文介绍：</p><p><b>简单请求</b>就是满足方法是GET、POST、HEAD，头域为Accept、Accept-Language、Content-Language、Last-Event-ID、Content-Type，且Content-Type只限于三个值：application/x-www-form-urlencoded、multipart/form-data、text/plain的请求，比如普通的提交HTML Form表单的请求。</p><p><b>非简单请求</b>，就是普通 HTML Form 无法实现的请求。比如 PUT 方法、需要其他的内容编码方式、自定义头之类的。</p><p><b>对于服务器来说：</b></p><p>第一，  许多服务器压根没打算给跨站访问使用，不会给CORS响应头，浏览器也会做相应报错，但是由于跨域访问不会阻止请求发出，但是请求本身可能已经造成了后果，所以最好能够阻止跨站请求发出。</p><p>第二，  要回答某个请求是否接受跨域访问，可能涉及额外的计算逻辑，这个逻辑可能简单，如一律放通；但也可能复杂，可能取决于哪个资源、哪种操作、来自哪个Origin。对于浏览器来说，它只需要知道能否跨域访问，但是对于服务器来说，计算成本可大可小。所以我们希望这种判断不需要每次由服务器进行计算。</p><p>CORS的<b>预检请求preflight</b>就是这样一种机制，浏览器先单独请求一次，询问服务器某个资源是否可以跨站访问，如果不允许的话，就在预检请求的响应中告知浏览器，使得浏览器不再发送实际请求。</p><p>这个机制即为“先许可，再请求”，因此默认禁止了跨站请求。</p><p>如果允许的话，浏览器才会继续发送实际请求，这样不合法跨站请求就不会对服务器造成任何影响。</p><p>但是这种机制，只能限于非简单请求。在处理简单请求的时候，如果服务器不打算接受跨站请求，不能依赖CORS预检请求preflight机制，因为普通表单会直接发起实际请求，所以默认禁止跨站的简单请求是做不到的。</p><p><b>因此，我们常在安全规范中看到，不要使用GET方法来提交重要敏感数据，不要使用简单的表单请求来提交敏感数据等，原因就在这里。</b></p><h2><b>6 总结</b></h2><p>浏览器跨域有三大方式，AJAX请求跨域、JSONP跨域、服务端转发跨域，每种跨域会适用于不同的业务场景。</p><p>其中，AJAX跨域使用场景较多，遵循W3C标准，由浏览器和服务器根据HTTP头域Access-Control开头的相关字段协商处理跨域流程。</p><p>HTTP请求还分为简单请求和非简单请求，在非简单请求的跨域访问时，还会触发预检请求preflight流程。</p><p><b>对于我们业务开发和测试的启示</b>：</p><p>对于重要敏感数据，不要使用GET、简单表单提交等简单HTTP请求来处理，需要使用非简单请求来处理，这样就没法通过JSONP等跨域手段来攻击获取敏感数据。</p><p>此外，除了不使用简单请求之外，还可以通过每次请求使用不同随机串、增加验证码方式二次校验等方法，来防止请求被跨站伪造。</p><h2><b>7 参考资料</b></h2><p>[1] <a href="https://link.zhihu.com/?target=http%3A//www.ruanyifeng.com/blog/2016/04/same-origin-policy.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">浏览器同源政策及其规避方法</a></p><p>[2] <a href="https://link.zhihu.com/?target=https%3A//juejin.im/post/5cad99796fb9a068ab40a29a" class=" wrap external" target="_blank" rel="nofollow noreferrer">彻底理解浏览器的跨域</a></p><p>[3] <a href="https://www.zhihu.com/question/268998684/answer/344949204" class="internal">为什么跨域的post请求区分为简单请求和非简单请求和content-type相关？</a></p><p>[4] <a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/xuaman/article/details/54340290" class=" wrap external" target="_blank" rel="nofollow noreferrer">浅谈CSRF跨域攻击</a></p><p><a href="https://link.zhihu.com/?target=http%3A//3ms.huawei.com/hi/restnew/attach%3Fapp_id%3D79%26w3_id%3Dl84164271%26fid%3D1437102214%26type%3D1%26gid%3D3300887" class=" wrap external" target="_blank" rel="nofollow noreferrer">深入理解浏览器跨域原理(演示程序).rar</a>( 1.38 MB, 0 downs )</p><p class="ztext-empty-paragraph"><br></p><p><b><a href="https://link.zhihu.com/?target=https%3A//bbs.huaweicloud.com/blogs%3Futm_source%3Dzhihu%26utm_medium%3Dblog-article%26utm_campaign%3Dblog-article" class=" wrap external" target="_blank" rel="nofollow noreferrer">点击关注，第一时间了解华为云新鲜技术~</a></b></p></div></div><div class="ContentItem-time">编辑于 07-13</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19552572&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19552572" target="_blank"><div class="Popover"><div id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover1-content">网页浏览器</div></div></a></span></div><div class="Tag Topic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19612046&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19612046" target="_blank"><div class="Popover"><div id="Popover2-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover2-content">跨域</div></div></a></span></div><div class="Tag Topic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19550901&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19550901" target="_blank"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover3-content">前端开发</div></div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-fixed is-bottom" style="width: 690px; bottom: 0px; left: 606.5px;"><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;159060398&quot;}}}"><span><button aria-label="赞同 10 " type="button" class="Button VoteButton VoteButton--up"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 10</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover4-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover5-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover5-content"><button type="button" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="Sticky--holder" style="position: static; top: auto; right: auto; bottom: 0px; left: 0px; display: block; float: none; margin: 0px 0px 10px; height: 54px;"></div></div></article><div class="Post-Sub Post-NormalSub"><div class="PostIndex-Contributions" data-za-detail-view-path-module="ColumnList" data-za-detail-view-path-module_name="文章被以下专栏收录" data-za-extra-module="{}"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="https://www.zhihu.com/column/c_1016019161834774528"><div class="Popover"><div id="Popover6-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover6-content"><img class="Avatar Avatar--medium Avatar--round" width="40" height="40" src="./详解浏览器跨域的几种方法 - 知乎_files/v2-dd3b579214bf8adfb9c0b7e7defb8dda_xs.jpg" srcset="https://pic4.zhimg.com/v2-dd3b579214bf8adfb9c0b7e7defb8dda_l.jpg?source=172ae18b 2x" alt="程序员之家"></div></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><a class="ColumnLink ColumnItem-Title" href="https://www.zhihu.com/column/c_1016019161834774528"><div class="Popover"><div id="Popover7-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover7-content">程序员之家</div></div></a></h2><div class="ContentItem-meta">欢迎投稿、交流</div></div><div class="ContentItem-extra"><a href="https://www.zhihu.com/column/c_1016019161834774528" type="button" class="Button">进入专栏</a></div></div></div></ul></div><div class="Recommendations-Main" style="width: 1903px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg class="Zi Zi--ArrowLeft" fill="#d3d3d3" viewBox="0 0 24 24" width="40" height="40"><path d="M14.782 16.78a.737.737 0 0 1-1.052 0L9.218 12.53a.758.758 0 0 1 0-1.063L13.73 7.22a.737.737 0 0 1 1.052 0c.29.294.29.77.001 1.063L11 12l3.782 3.716c.29.294.29.77 0 1.063z" fill-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/95314531" class="PostItem"><div><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-71bf7651664b01dd2d0cd6c00f1de062_250x0.jpg" srcset="https://pic2.zhimg.com/v2-71bf7651664b01dd2d0cd6c00f1de062_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="【浏览器】实在不想再搞跨域的问题了"><h1 class="PostItem-Title">【浏览器】实在不想再搞跨域的问题了</h1><div class="PostItem-Footer"><span>Henry YANG</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/66484450" class="PostItem"><div><img src="./详解浏览器跨域的几种方法 - 知乎_files/v2-3036165c2da2a985fbea3d45b97b585a_250x0.jpg" srcset="https://pic1.zhimg.com/v2-3036165c2da2a985fbea3d45b97b585a_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="一文搞懂跨域的所有问题，生活从此669~"><h1 class="PostItem-Title">一文搞懂跨域的所有问题，生活从此669~</h1><div class="PostItem-Footer"><span>慕课网</span><span class="PostItem-FooterTitle">发表于猿论</span></div></div></a><a href="https://zhuanlan.zhihu.com/p/63629321" class="PostItem"><div><h1 class="PostItem-Title">前端战五渣学前端——跨域</h1><p class="PostItem-Summary">跨域（Cross-Origin） 这几年的工作、面试中，还遇到一个不能回避的问题，那就是跨域，一般面试的时候会问你‘怎么解决跨域问题’，‘跨域是什么’，‘为什么会有跨域’等类似的问题。前段…</p><div class="PostItem-Footer"><span>戈德斯文</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/85763027" class="PostItem"><div><h1 class="PostItem-Title">浏览器知识</h1><p class="PostItem-Summary">一、缓存1. 缓存发展的历史在前端开发中，性能一直都是被大家所重视的一点，然而判断一个网站的性能最直观的就是看网页打开的速度。其中提高网页反应速度的一个方式就是使用缓存。缓存技术…</p><div class="PostItem-Footer"><span>秋尘</span><span class="PostItem-FooterTitle">发表于前端经验分...</span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg class="Zi Zi--ArrowRight" fill="#d3d3d3" viewBox="0 0 24 24" width="40" height="40"><path d="M9.218 16.78a.737.737 0 0 0 1.052 0l4.512-4.249a.758.758 0 0 0 0-1.063L10.27 7.22a.737.737 0 0 0-1.052 0 .759.759 0 0 0-.001 1.063L13 12l-3.782 3.716a.758.758 0 0 0 0 1.063z" fill-rule="evenodd"></path></svg></button></ul></div><div class="Comments-container" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="CommentsV2 CommentsV2--withEditor CommentsV2-withPagination"><div class="Topbar CommentTopbar"><div class="Topbar-title"><h2 class="CommentTopbar-title">还没有评论</h2></div><div class="Topbar-options"></div></div><div><div class="CommentsV2-footer CommentEditorV2--normal"><div class="CommentEditorV2-inputWrap"><div class="InputLike CommentEditorV2-input Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 198px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-9r2le" style="white-space: pre-wrap;">写下你的评论...</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-9r2le" class="notranslate public-DraftEditor-content" contenteditable="true" role="textbox" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word;"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="9r2le" data-offset-key="a8ge3-0-0"><div data-offset-key="a8ge3-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="a8ge3-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><input multiple="" type="file" accept="image/jpg,image/jpeg,image/png,image/gif" style="display: none;"><div></div></div><div class="CommentEditorV2-inputUpload"><div class="CommentEditorV2-popoverWrap"><div class="Popover CommentEditorV2-inputUpLoad-Icon"><button aria-label="插入表情" data-tooltip="插入表情" data-tooltip-position="bottom" data-tooltip-will-hide-on-click="true" id="Popover10-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover10-content" type="button" class="Button Editable-control Button--plain"><svg class="Zi Zi--Emotion" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M7.523 13.5h8.954c-.228 2.47-2.145 4-4.477 4-2.332 0-4.25-1.53-4.477-4zM12 21a9 9 0 1 1 0-18 9 9 0 0 1 0 18zm0-1.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15zm-3-8a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm6 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"></path></svg></button></div></div></div></div><button type="button" disabled="" class="Button CommentEditorV2-singleButton Button--primary Button--blue">发布</button></div></div><div><div class="CommentListV2"></div></div></div></div></div></div></main><div class="CornerButtons"><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain"><svg class="Zi Zi--BackToTop" aria-label="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button></div></div></div></div><script nonce="" async="" src="./详解浏览器跨域的几种方法 - 知乎_files/js"></script><script nonce="">function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-149949619-1");</script><script id="js-clientConfig" type="text/json">{"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false}},"club":{"tags":{},"admins":{"data":[]},"members":{"data":[]},"explore":{"candidateSyncClubs":{}},"profile":{},"checkin":{},"comments":{"paging":{},"loading":{},"meta":{},"ids":{}},"postList":{"paging":{},"loading":{},"ids":{}},"recommend":{"data":[]},"silences":{"data":[]},"application":{"profile":null}},"entities":{"users":{"hua-wei-yun-ji-zhu-zhai-ji-di":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de.jpg?source=172ae18b","uid":"984835495964078080","userType":"organization","isFollowing":false,"urlToken":"hua-wei-yun-ji-zhu-zhai-ji-di","id":"a97ebcb387aaf4dec46f5179b8a71ec9","description":"华为云开发者社区，提供全面深入的云计算前景分析、丰富的技术干货、程序样例，分享华为云前沿资讯动态，方便开发者快速成长与发展，欢迎提问、互动，多方位了解云计算！","name":"华为云开发者社区","isAdvertiser":false,"headline":"来自华为云的新鲜技术分享","gender":1,"url":"\u002Forg\u002Fa97ebcb387aaf4dec46f5179b8a71ec9","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b","isOrg":true,"type":"people","levelInfo":{"nicknameColor":{"color":"","nightModeColor":""},"exp":33,"level":1,"notice":"签到领奖励","levelIcon":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-3e1b8da6be5ec3f254999f553746f287_l.jpg"},"badge":[{"type":"identity","topics":[],"description":"已认证的官方帐号"}],"badgeV2":{"title":"已认证的官方帐号","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"已认证的官方帐号","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_org","title":"已认证的官方帐号","description":"已认证的官方帐号","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png"}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png"}}},"questions":{},"answers":{},"articles":{"159060398":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fpage_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=__MEMBERID__&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"id":159060398,"title":"详解浏览器跨域的几种方法","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F159060398","imageUrl":"","titleImage":"","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-eeca312dea6ba174b340ea2f329fa871_200x112.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"489\" data-rawheight=\"371\" data-watermark=\"\" data-original-src=\"\" data-watermark-src=\"\" data-private-watermark-src=\"\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-eeca312dea6ba174b340ea2f329fa871_r.jpg\" class=\"origin_image inline-img zh-lightbox-thumb\"\u002F\u003E\u003Cb\u003E摘要：\u003C\u002Fb\u003E本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。\u003Cb\u003E1 前言\u003C\u002Fb\u003E在WEB前端开发中，我们经常会碰到“跨域”问题，最常见的就是浏览器在A域名页面发送B域名的请求时会被限制。跨域问题涉及…","created":1594622973,"updated":1594623058,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de.jpg?source=172ae18b","uid":"984835495964078080","userType":"organization","isFollowing":false,"urlToken":"hua-wei-yun-ji-zhu-zhai-ji-di","id":"a97ebcb387aaf4dec46f5179b8a71ec9","description":"华为云开发者社区，提供全面深入的云计算前景分析、丰富的技术干货、程序样例，分享华为云前沿资讯动态，方便开发者快速成长与发展，欢迎提问、互动，多方位了解云计算！","name":"华为云开发者社区","isAdvertiser":false,"headline":"来自华为云的新鲜技术分享","gender":1,"url":"\u002Forg\u002Fa97ebcb387aaf4dec46f5179b8a71ec9","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b","isOrg":true,"type":"people","levelInfo":{"nicknameColor":{"color":"","nightModeColor":""},"exp":33,"level":1,"notice":"签到领奖励","levelIcon":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-3e1b8da6be5ec3f254999f553746f287_l.jpg"},"badge":[{"type":"identity","topics":[],"description":"已认证的官方帐号"}],"badgeV2":{"title":"已认证的官方帐号","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"已认证的官方帐号","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_org","title":"已认证的官方帐号","description":"已认证的官方帐号","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png"}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png"}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","imageWidth":0,"imageHeight":0,"content":"\u003Cblockquote\u003E\u003Cb\u003E摘要：\u003C\u002Fb\u003E本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。\u003C\u002Fblockquote\u003E\u003Ch2\u003E\u003Cb\u003E1 前言\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E在WEB前端开发中，我们经常会碰到“跨域”问题，最常见的就是浏览器在A域名页面发送B域名的请求时会被限制。跨域问题涉及到WEB网页安全性问题，使用不当会造成用户隐私泄露风险，但有时业务上又需要进行跨域请求。如何正确的使用跨域功能，既能满足业务需求，又能够满足安全性要求，显得尤为重要。\u003C\u002Fp\u003E\u003Cp\u003E本文针对浏览器的跨域特性，做一下深入介绍，以便我们在进行WEB前端开发和测试时，对浏览器跨域特性有全面的理解和掌握。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E2 背景知识介绍\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E\u003Cb\u003E2.1 同源政策\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E1995年，同源政策由 Netscape 公司引入浏览器。目前，所有浏览器都实行这个政策。\u003C\u002Fp\u003E\u003Cp\u003E最初，它的含义是指，A 网页设置的 Cookie，B 网页不能打开，除非这两个网页“同源”。所谓“同源”指的是“三个相同”：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E协议相同\u003C\u002Fli\u003E\u003Cli\u003E域名相同\u003C\u002Fli\u003E\u003Cli\u003E端口相同\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E同源政策的目的，是为了保证用户信息的安全，防止恶意的网站窃取数据。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E设想这样一种情况：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003EA 网站是一家银行，用户登录以后，A 网站在用户的机器上设置了一个 Cookie，包含了一些隐私信息（比如存款总额）。用户离开 A 网站以后，又去访问 B 网站，如果没有同源限制，B 网站可以读取 A 网站的 Cookie，那么隐私信息就会泄漏。更可怕的是，Cookie 往往用来保存用户的登录状态，如果用户没有退出登录，其他网站就可以冒充用户，为所欲为。因为浏览器同时还规定，提交表单不受同源政策的限制。由此可见，同源政策是必需的，否则 Cookie 可以共享，互联网就毫无安全可言了。\u003C\u002Fp\u003E\u003Cp\u003E当前，如果非同源，共有三种行为受到限制：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003ECookie、LocalStorage 和 IndexDB 无法读取\u003C\u002Fli\u003E\u003Cli\u003EDOM 无法获得\u003C\u002Fli\u003E\u003Cli\u003EAJAX 请求不能发送\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cb\u003E2.2 为什么要有跨域限制\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003EAjax 的同源策略\u003C\u002Fb\u003E主要是为了防止 \u003Cb\u003ECSRF（跨站请求伪造）\u003C\u002Fb\u003E 攻击，如果没有 AJAX 同源策略，相当危险，我们发起的每一次 HTTP 请求都会带上请求地址对应的 cookie，那么可以做如下攻击：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E用户登录了自己的银行页面 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fmybank.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Emybank.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E，\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fmybank.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Emybank.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E向用户的cookie中添加用户标识。\u003C\u002Fli\u003E\u003Cli\u003E用户浏览了恶意页面 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fevil.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Eevil.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E。执行了页面中的恶意AJAX请求代码。\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fevil.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Eevil.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E向\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fmybank.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Emybank.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E发起AJAX HTTP请求，请求会默认把\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fmybank.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Emybank.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E对应cookie也同时发送过去。\u003C\u002Fli\u003E\u003Cli\u003E银行页面从发送的cookie中提取用户标识，验证用户无误，response中返回请求数据。此时数据就泄露了。\u003C\u002Fli\u003E\u003Cli\u003E而且由于Ajax在后台执行，用户无法感知这一过程。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cb\u003EDOM同源策略\u003C\u002Fb\u003E也一样，如果 iframe 之间可以跨域访问，可以这样攻击：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E做一个假网站，里面用iframe嵌套一个银行网站 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fmybank.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Emybank.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E。\u003C\u002Fli\u003E\u003Cli\u003E把iframe宽高啥的调整到页面全部，这样用户进来除了域名，别的部分和银行的网站没有任何差别。\u003C\u002Fli\u003E\u003Cli\u003E这时如果用户输入账号密码，我们的主网站可以跨域访问到\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fmybank.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Emybank.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E的dom节点，就可以拿到用户的输入了，那么就完成了一次攻击。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E 所以有了跨域访问限制之后，我们才能够安全的上网。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E3 浏览器跨域的解决方案\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E\u003Cb\u003E3.1 CORS标准\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003ECORS 是一个 W3C 标准，全称是跨域资源共享（CORSs-origin resource sharing），它允许浏览器向跨源服务器，发出XMLHttpRequest请求。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E其实，准确的来说，跨域机制是阻止了数据的跨域获取，不是阻止请求发送。\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003ECORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fcaniuse.com\u002F%23search%3Dcors\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Ecaniuse.com\u002F#\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Esearch=cors\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-eeca312dea6ba174b340ea2f329fa871_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"489\" data-rawheight=\"371\" class=\"origin_image zh-lightbox-thumb\" width=\"489\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-eeca312dea6ba174b340ea2f329fa871_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;489&#39; height=&#39;371&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"489\" data-rawheight=\"371\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"489\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-eeca312dea6ba174b340ea2f329fa871_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-eeca312dea6ba174b340ea2f329fa871_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。\u003C\u002Fp\u003E\u003Cp\u003E因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨域通信。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E3.2 CORS跨域判定的总体流程\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1338484aef123b761da2c3880531d317_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"463\" class=\"origin_image zh-lightbox-thumb\" width=\"643\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1338484aef123b761da2c3880531d317_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;643&#39; height=&#39;463&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"463\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"643\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1338484aef123b761da2c3880531d317_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1338484aef123b761da2c3880531d317_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E如图所示，跨域的判定流程为：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E网页上的JS代码，从浏览器上发送XMLHttpRequest请求到服务端\u003C\u002Fli\u003E\u003Cli\u003E如果该请求为\u003Cb\u003E简单请求\u003C\u002Fb\u003E，浏览器会直接发送实际请求到服务端，浏览器会根据服务端的响应，判断该请求是否可以跨域：\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E    （1）如果不能跨域，浏览器会报错，阻止JS代码进一步执行；\u003C\u002Fp\u003E\u003Cp\u003E    （2）如果能够跨域，则JS能正常处理响应，进行后续业务流程\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E如果该请求为\u003Cb\u003E非简单请求\u003C\u002Fb\u003E，浏览器会先发送一个预检请求(preflight)，方法为OPTIONS，然后针对服务器的响应，做上述跟简单请求一样相同的判断：\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E   （1）如果不能跨域，则实际请求不会发送\u003C\u002Fp\u003E\u003Cp\u003E   （2）如果能够跨域，则实际请求会进行发送，进行后续业务处理\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E值得说明的是，浏览器在跨域的情况下，请求都会发送出去\u003C\u002Fb\u003E，但是对于响应会判断是否满足跨域条件，如果不满足，则报错，阻止JS后续的执行流程，例如读取响应数据等。也就是说，\u003Cb\u003E跨域机制主要是阻止数据的跨域获取，不是阻止请求的发送\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E3.3 简单请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E实际上浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。\u003C\u002Fp\u003E\u003Cp\u003E只要同时满足以下条件，就属于简单请求，\u003Cb\u003E一般来说，只需要满足前两个即可\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E请求方法是如下三种方法之一：GET、POST、HEAD\u003C\u002Fli\u003E\u003Cli\u003EHTTP消息头不超过如下几个字段：\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E   Accept\u003C\u002Fp\u003E\u003Cp\u003E   Accept-Language\u003C\u002Fp\u003E\u003Cp\u003E  Content-Language\u003C\u002Fp\u003E\u003Cp\u003E  Last-Event-ID\u003C\u002Fp\u003E\u003Cp\u003E  Content-Type：只限于三个值：application\u002Fx-www-form-urlencoded、multipart\u002Fform-data、text\u002Fplain\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E请求中的任意XMLHttpRequestUpload 对象均没有注册任何事件**器\u003C\u002Fli\u003E\u003Cli\u003EXMLHttpRequestUpload 对象可以使用 XMLHttpRequest.upload 属性访问。请求中没有使用 ReadableStream 对象\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E对于简单请求，浏览器会直接发起CORS请求，将实际请求发给服务器，服务器返回响应给浏览器，同时在响应头域中携带CORS相关头域，供浏览器进行跨域判断。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E3.4 非简单请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E非简单请求时指那些对服务器有特殊要求的请求，比如请求方法是 PUT或 DELETE，或者 Content-Type 的类型是 application\u002Fjson。简而言之，不是简单请求的HTTP请求，都是非简单请求。\u003C\u002Fp\u003E\u003Cp\u003E非简单请求的 CORS 请求，会在正式通信之前，使用 OPTIONS 方法发起一个预检（preflight）请求到服务器，浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些 HTTP方法和头信息字段。只有得到肯定答复，浏览器才会发出正式的 XMLHttpRequest 请求，否则就报错。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E3.5 CORS相关头域\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E那么，无论是简单请求，还是非简单请求，浏览器都会对响应头域中的CORS相关字段进行判断，CORS的常见字段有如下几个：\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E3.5.1 Access-Control-Allow-Origin(必选)\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E涉及简单Http请求、非简单Http请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E含义\u003C\u002Fb\u003E：允许的域名，只能填 *（通配符）或者单域名\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E举例\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cp\u003E从\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fwww.huaweicloud.com\u003C\u002Fa\u003E网页，发送\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fportal.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fportal.huaweicloud.com\u003C\u002Fa\u003E请求，如果服务器响应头域中没有填写Access-Control-Allow-Origin，浏览器会报错：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-755134dd6b401b6b37b3f983d10e2e75_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"92\" class=\"origin_image zh-lightbox-thumb\" width=\"643\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-755134dd6b401b6b37b3f983d10e2e75_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;643&#39; height=&#39;92&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"92\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"643\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-755134dd6b401b6b37b3f983d10e2e75_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-755134dd6b401b6b37b3f983d10e2e75_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E或者取值不为\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fwww.huaweicloud.com\u003C\u002Fa\u003E，浏览器也会报错：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-58dd302c79d76be292cb29dc5453a3a5_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"94\" class=\"origin_image zh-lightbox-thumb\" width=\"642\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-58dd302c79d76be292cb29dc5453a3a5_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;642&#39; height=&#39;94&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"94\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"642\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-58dd302c79d76be292cb29dc5453a3a5_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-58dd302c79d76be292cb29dc5453a3a5_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E填写为*或者\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fwww.huaweicloud.com\u003C\u002Fa\u003E，则不会报错：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f6ec80b05fa4182632ce9c2e42b06fc2_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"583\" data-rawheight=\"216\" class=\"origin_image zh-lightbox-thumb\" width=\"583\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f6ec80b05fa4182632ce9c2e42b06fc2_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;583&#39; height=&#39;216&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"583\" data-rawheight=\"216\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"583\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f6ec80b05fa4182632ce9c2e42b06fc2_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f6ec80b05fa4182632ce9c2e42b06fc2_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-24146168d66ee16ad3987823a571c812_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"522\" data-rawheight=\"245\" class=\"origin_image zh-lightbox-thumb\" width=\"522\" data-original=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-24146168d66ee16ad3987823a571c812_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;522&#39; height=&#39;245&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"522\" data-rawheight=\"245\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"522\" data-original=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-24146168d66ee16ad3987823a571c812_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-24146168d66ee16ad3987823a571c812_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cb\u003E3.5.2 Access-Control-Allow-Credentials(可选)\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E涉及简单Http请求、非简单Http请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E含义\u003C\u002Fb\u003E：表示是否允许发送Cookie，只有一个可选值：true（必为小写）。如果不包含cookies，请略去该项，而不是填写false。这一项与 XmlHttpRequest 对象当中的 withCredentials 属性应保持一致，即 withCredentials 为true时该项也为true；withCredentials 为false时，省略该项不写。反之则导致请求失败。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E举例\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cp\u003E当XmlHttpRequest中设置了withCredentials为true，如果服务器响应里没有Access-Control-Allow-Credentials字段，则浏览器会报错：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e1988ad7dadef9d7a27da7121e4a1cf5_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"115\" class=\"origin_image zh-lightbox-thumb\" width=\"642\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e1988ad7dadef9d7a27da7121e4a1cf5_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;642&#39; height=&#39;115&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"115\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"642\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e1988ad7dadef9d7a27da7121e4a1cf5_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e1988ad7dadef9d7a27da7121e4a1cf5_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E特别的，当XmlHttpRequest中设置了withCredentials为true时，还要求Access-Control-Allow-Origin字段不能为通配符*，其实这也好理解，因为设置了withCredentials，表示允许跨域发送Cookie，如果Origin允许为*的话，安全性就会大大降低了，很容易构造跨站攻击：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f9fa52686c3265bc8ad5ba9ca9516e13_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"121\" class=\"origin_image zh-lightbox-thumb\" width=\"642\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f9fa52686c3265bc8ad5ba9ca9516e13_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;642&#39; height=&#39;121&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"121\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"642\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f9fa52686c3265bc8ad5ba9ca9516e13_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f9fa52686c3265bc8ad5ba9ca9516e13_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cb\u003E3.5.3 Access-Control-Expose-Headers(可选)\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E涉及简单Http请求、非简单Http请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E含义\u003C\u002Fb\u003E：CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E举例\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cp\u003E在JS代码中，通过XMLHttpRequest对象来获取响应中的wise_traceid头域，如：\u003C\u002Fp\u003E\u003Cp\u003Exhr. getResponseHeader(&#34;wise_traceid&#34;)\u003C\u002Fp\u003E\u003Cp\u003E如果在服务器响应中，没有携带Access-Control-Expose-Headers或者Access-Control-Expose-Headers的值不包含wise_traceid，则浏览器会报错，JS拿到的值也是null：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-c31b10c8c7743cb2a09a5172e93f6d4d_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"65\" class=\"origin_image zh-lightbox-thumb\" width=\"643\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-c31b10c8c7743cb2a09a5172e93f6d4d_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;643&#39; height=&#39;65&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"65\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"643\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-c31b10c8c7743cb2a09a5172e93f6d4d_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-c31b10c8c7743cb2a09a5172e93f6d4d_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cb\u003E3.5.4 预检请求preflight\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E根据上述分析，如果是非简单Http请求，浏览器会先发送一个预检请求，要求服务器进行确认。预检请求使用的方法是OPTIONS，表示这个请求是用来询问的，头信息里面，关键字段是Origin，表示请求来自哪个源。\u003C\u002Fp\u003E\u003Cp\u003E除了Origin字段，&#34;预检&#34;请求的头信息包括两个特殊字段：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cb\u003EAccess-Control-Request-Method\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E该字段是必须的，用来列出浏览器的CORS请求会用到哪些HTTP方法，如PUT：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8d320e9285261aed66748738874322e1_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"578\" data-rawheight=\"249\" class=\"origin_image zh-lightbox-thumb\" width=\"578\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8d320e9285261aed66748738874322e1_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;578&#39; height=&#39;249&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"578\" data-rawheight=\"249\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"578\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8d320e9285261aed66748738874322e1_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8d320e9285261aed66748738874322e1_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cul\u003E\u003Cli\u003E\u003Cb\u003EAccess-Control-Request-Headers\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，当使用了简单请求那5个字段之外的字段，浏览器会在OPTIONS请求头域中，指定 Access-Control-Request-Headers的取值，如：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-cbd08931b1d010b3890c27b84b50e4af_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"587\" data-rawheight=\"210\" class=\"origin_image zh-lightbox-thumb\" width=\"587\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-cbd08931b1d010b3890c27b84b50e4af_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;587&#39; height=&#39;210&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"587\" data-rawheight=\"210\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"587\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-cbd08931b1d010b3890c27b84b50e4af_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-cbd08931b1d010b3890c27b84b50e4af_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cb\u003E如果预检请求的响应，浏览器没有校验通过，不允许跨域，浏览器除了会在控制台报错之外，后续实际请求也不会发送了。\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E3.5.5 Access-Control-Allow-Methods(必选)\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E涉及非简单Http请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E含义\u003C\u002Fb\u003E：允许跨域请求的 http 方法（如\u003Cb\u003EPOST\u003C\u002Fb\u003E、\u003Cb\u003EGET\u003C\u002Fb\u003E、\u003Cb\u003EOPTIONS、PUT、DELETE\u003C\u002Fb\u003E），该字段是对于预检请求中的Access-Control-Request-Method的回复。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E备注\u003C\u002Fb\u003E：对于简单请求的GET、POST方法，该字段不是必选的，浏览器会默认允许这两个方法进行跨域\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E举例\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cp\u003E从\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fwww.huaweicloud.com\u003C\u002Fa\u003E，跨域访问\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fportal.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fportal.huaweicloud.com\u003C\u002Fa\u003E，HTTP方法为POST，如果服务器响应里没有Access-Control-Allow-Methods，跨域请求能够成功：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-d4d8159011f85aac0beb516c8c5a91f7_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"396\" class=\"origin_image zh-lightbox-thumb\" width=\"642\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-d4d8159011f85aac0beb516c8c5a91f7_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;642&#39; height=&#39;396&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"396\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"642\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-d4d8159011f85aac0beb516c8c5a91f7_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-d4d8159011f85aac0beb516c8c5a91f7_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E如果服务器响应里Access-Control-Allow-Methods不包含POST，跨域请求也能成功：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-f5e622ed0433d59162ff09f535ce1d86_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"394\" class=\"origin_image zh-lightbox-thumb\" width=\"642\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-f5e622ed0433d59162ff09f535ce1d86_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;642&#39; height=&#39;394&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"394\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"642\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-f5e622ed0433d59162ff09f535ce1d86_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-f5e622ed0433d59162ff09f535ce1d86_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E如果请求为PUT方法，但响应里没有携带Access-Control-Allow-Methods或者取值不包含PUT，浏览器会报错：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-723fb0839cf562082e3a039864098173_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"92\" class=\"origin_image zh-lightbox-thumb\" width=\"643\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-723fb0839cf562082e3a039864098173_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;643&#39; height=&#39;92&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"92\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"643\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-723fb0839cf562082e3a039864098173_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-723fb0839cf562082e3a039864098173_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cb\u003E3.5.6 Access-Control-Allow-Headers(可选)\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E涉及非简单Http请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E含义\u003C\u002Fb\u003E：该字段指定了跨域允许设置的非简单Http请求头（5个简单Http请求头之外的头域），（当预请求中包含 Access-Control-Request-Headers 时必须包含）– 这是对预请求当中 Access-Control-Request-Headers 的回复，和上面一样是以逗号分隔的列表，可以返回所有支持的头部。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E举例\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cp\u003E如果在XMLHttpRequest中设置了wise_groupid字段，而服务器响应中，没有Access-Control-Allow-Headers头域，或者Access-Control-Allow-Headers头域的值不包含wise_groupid，则浏览器会报错：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-785c7dd100b69337bf323b112abb753b_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"93\" class=\"origin_image zh-lightbox-thumb\" width=\"643\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-785c7dd100b69337bf323b112abb753b_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;643&#39; height=&#39;93&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"93\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"643\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-785c7dd100b69337bf323b112abb753b_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-785c7dd100b69337bf323b112abb753b_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cb\u003E3.5.7 Access-Control-Max-Age(可选)\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E涉及简单Http请求、非简单Http请求\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E含义\u003C\u002Fb\u003E：用来指定本次预检请求的有效期，单位为秒。例如，Access-Control-Max-Age被设置为1728000，表示有效期是20天（1728000秒），即允许缓存该条回应1728000秒（即20天），在此期间，不用发出另一条预检请求。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E4 其它跨域手段\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E\u003Cb\u003E4.1 JSONP跨域\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E在HTML文档中，有一个script标签，该标签一般会引用当前HTML文档需要加载的js脚本，例如：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-f74a4832f87fa94733abbbdaecf3bc05_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"22\" class=\"origin_image zh-lightbox-thumb\" width=\"642\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-f74a4832f87fa94733abbbdaecf3bc05_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;642&#39; height=&#39;22&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"642\" data-rawheight=\"22\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"642\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-f74a4832f87fa94733abbbdaecf3bc05_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-f74a4832f87fa94733abbbdaecf3bc05_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E浏览器在加载HTML文档时，会顺序加载script标签中src的地址，这种加载是可以跨域加载的，浏览器不会阻止跨域的js加载。\u003C\u002Fp\u003E\u003Cp\u003E此外，还有img等标签，可以跨域加载。\u003C\u002Fp\u003E\u003Cp\u003E而 JSONP正是利用了script\u002Fimg等标签能够跨域加载，来实现跨域请求的功能，如下代码所示：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6384a977980e126910a6e7b6f8948ff4_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"545\" data-rawheight=\"135\" class=\"origin_image zh-lightbox-thumb\" width=\"545\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6384a977980e126910a6e7b6f8948ff4_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;545&#39; height=&#39;135&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"545\" data-rawheight=\"135\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"545\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6384a977980e126910a6e7b6f8948ff4_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6384a977980e126910a6e7b6f8948ff4_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E代码先定义一个全局函数，然后把这个函数名通过callback参数添加到script标签的src，script的src就是需要跨域的请求，然后这个请求返回可执行的JS文本：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5b0f3cc62bb7fb539d80ce3a001f2a04_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"545\" data-rawheight=\"52\" class=\"origin_image zh-lightbox-thumb\" width=\"545\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5b0f3cc62bb7fb539d80ce3a001f2a04_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;545&#39; height=&#39;52&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"545\" data-rawheight=\"52\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"545\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5b0f3cc62bb7fb539d80ce3a001f2a04_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5b0f3cc62bb7fb539d80ce3a001f2a04_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E由于它是一个js，并且已经定义了upldateList函数，所以能正常执行，并且跨域的数据通过传参得到。这就是JSONP的原理。\u003C\u002Fp\u003E\u003Cp\u003E如下图所示，服务器返回了响应之后，js方法updateList就可以获取到响应内容，打印在控制台：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-957d057bb700d036af6f07daaa7a4e5e_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"471\" data-rawheight=\"101\" class=\"origin_image zh-lightbox-thumb\" width=\"471\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-957d057bb700d036af6f07daaa7a4e5e_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;471&#39; height=&#39;101&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"471\" data-rawheight=\"101\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"471\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-957d057bb700d036af6f07daaa7a4e5e_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-957d057bb700d036af6f07daaa7a4e5e_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-fd95c434824c299fe5c80328cd92dcbf_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"331\" data-rawheight=\"75\" class=\"content_image\" width=\"331\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;331&#39; height=&#39;75&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"331\" data-rawheight=\"75\" class=\"content_image lazy\" width=\"331\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-fd95c434824c299fe5c80328cd92dcbf_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EJSONP方式跨域访问的时候，还会携带域名的Cookie：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-318b4f983a2f9cb615509fac47c759da_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"181\" class=\"origin_image zh-lightbox-thumb\" width=\"643\" data-original=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-318b4f983a2f9cb615509fac47c759da_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;643&#39; height=&#39;181&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"643\" data-rawheight=\"181\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"643\" data-original=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-318b4f983a2f9cb615509fac47c759da_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpicb.zhimg.com\u002Fv2-318b4f983a2f9cb615509fac47c759da_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E从上面可以看到，JSONP方式跨域，会不受同源政策影响，并且会携带跨域域名的Cookie，同样也会存在安全风险。\u003C\u002Fp\u003E\u003Cp\u003E由于JSONP是利用script\u002Fimg等标签来实现跨域，而浏览器加载这些标签，使用的是GET方法，这就要求业务对于一些重要的请求，不能够使用GET方法提交数据，必须要使用POST方法，这样就无法利用JSONP进行跨域请求了。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E4.2 服务端转发\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-20fd19e07a8c16e3c90c586c74e8e0aa_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"603\" data-rawheight=\"272\" class=\"origin_image zh-lightbox-thumb\" width=\"603\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-20fd19e07a8c16e3c90c586c74e8e0aa_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;603&#39; height=&#39;272&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"603\" data-rawheight=\"272\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"603\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-20fd19e07a8c16e3c90c586c74e8e0aa_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-20fd19e07a8c16e3c90c586c74e8e0aa_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E如上图所示，服务端转发实现跨域访问的基本原理是，将访问B域名的请求，通过访问A域名，由A服务器转发给B服务器：\u003C\u002Fp\u003E\u003Cp\u003E举例：\u003C\u002Fp\u003E\u003Cp\u003E在\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttps:\u002F\u002Fwww.huaweicloud.com\u003C\u002Fa\u003E页面上，想要访问\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fportal.huaweicloud.com\u002Fv1\u002Ftemplate\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Eportal.huaweicloud.com\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Ev1\u002Ftemplate\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E接口，那么可以通过如下手段实现跨域：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E页面上调用\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fwww.huaweicloud.com\u002Fportal\u002Fv1\u002Ftemplate\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002Fwww.\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Ehuaweicloud.com\u002Fportal\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Ev1\u002Ftemplate\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E接口\u003C\u002Fli\u003E\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ewww.huaweicloud.com\u003C\u002Fa\u003E服务器，对于\u002Fportal开头的请求，统一去掉portal路径，转发给portal.huaweicloud.com服务器，相当于\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww.huaweicloud.com\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ewww.huaweicloud.com\u003C\u002Fa\u003E服务器做了反向代理\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E但是使用该方法，会导致无法发送\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fportal.huaweicloud.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Eportal.huaweicloud.com\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E域名下的cookie，因此应用场景有限。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E5 扩展\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E\u003Cb\u003E5.1 为什么要区分简单请求和非简单请求？\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E按照上文介绍：\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E简单请求\u003C\u002Fb\u003E就是满足方法是GET、POST、HEAD，头域为Accept、Accept-Language、Content-Language、Last-Event-ID、Content-Type，且Content-Type只限于三个值：application\u002Fx-www-form-urlencoded、multipart\u002Fform-data、text\u002Fplain的请求，比如普通的提交HTML Form表单的请求。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E非简单请求\u003C\u002Fb\u003E，就是普通 HTML Form 无法实现的请求。比如 PUT 方法、需要其他的内容编码方式、自定义头之类的。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E对于服务器来说：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E第一，  许多服务器压根没打算给跨站访问使用，不会给CORS响应头，浏览器也会做相应报错，但是由于跨域访问不会阻止请求发出，但是请求本身可能已经造成了后果，所以最好能够阻止跨站请求发出。\u003C\u002Fp\u003E\u003Cp\u003E第二，  要回答某个请求是否接受跨域访问，可能涉及额外的计算逻辑，这个逻辑可能简单，如一律放通；但也可能复杂，可能取决于哪个资源、哪种操作、来自哪个Origin。对于浏览器来说，它只需要知道能否跨域访问，但是对于服务器来说，计算成本可大可小。所以我们希望这种判断不需要每次由服务器进行计算。\u003C\u002Fp\u003E\u003Cp\u003ECORS的\u003Cb\u003E预检请求preflight\u003C\u002Fb\u003E就是这样一种机制，浏览器先单独请求一次，询问服务器某个资源是否可以跨站访问，如果不允许的话，就在预检请求的响应中告知浏览器，使得浏览器不再发送实际请求。\u003C\u002Fp\u003E\u003Cp\u003E这个机制即为“先许可，再请求”，因此默认禁止了跨站请求。\u003C\u002Fp\u003E\u003Cp\u003E如果允许的话，浏览器才会继续发送实际请求，这样不合法跨站请求就不会对服务器造成任何影响。\u003C\u002Fp\u003E\u003Cp\u003E但是这种机制，只能限于非简单请求。在处理简单请求的时候，如果服务器不打算接受跨站请求，不能依赖CORS预检请求preflight机制，因为普通表单会直接发起实际请求，所以默认禁止跨站的简单请求是做不到的。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E因此，我们常在安全规范中看到，不要使用GET方法来提交重要敏感数据，不要使用简单的表单请求来提交敏感数据等，原因就在这里。\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E6 总结\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E浏览器跨域有三大方式，AJAX请求跨域、JSONP跨域、服务端转发跨域，每种跨域会适用于不同的业务场景。\u003C\u002Fp\u003E\u003Cp\u003E其中，AJAX跨域使用场景较多，遵循W3C标准，由浏览器和服务器根据HTTP头域Access-Control开头的相关字段协商处理跨域流程。\u003C\u002Fp\u003E\u003Cp\u003EHTTP请求还分为简单请求和非简单请求，在非简单请求的跨域访问时，还会触发预检请求preflight流程。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E对于我们业务开发和测试的启示\u003C\u002Fb\u003E：\u003C\u002Fp\u003E\u003Cp\u003E对于重要敏感数据，不要使用GET、简单表单提交等简单HTTP请求来处理，需要使用非简单请求来处理，这样就没法通过JSONP等跨域手段来攻击获取敏感数据。\u003C\u002Fp\u003E\u003Cp\u003E此外，除了不使用简单请求之外，还可以通过每次请求使用不同随机串、增加验证码方式二次校验等方法，来防止请求被跨站伪造。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E7 参考资料\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp\u003E[1] \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww.ruanyifeng.com\u002Fblog\u002F2016\u002F04\u002Fsame-origin-policy.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E浏览器同源政策及其规避方法\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E[2] \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fjuejin.im\u002Fpost\u002F5cad99796fb9a068ab40a29a\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E彻底理解浏览器的跨域\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E[3] \u003Ca href=\"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F268998684\u002Fanswer\u002F344949204\" class=\"internal\"\u003E为什么跨域的post请求区分为简单请求和非简单请求和content-type相关？\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E[4] \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fblog.csdn.net\u002Fxuaman\u002Farticle\u002Fdetails\u002F54340290\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E浅谈CSRF跨域攻击\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002F3ms.huawei.com\u002Fhi\u002Frestnew\u002Fattach%3Fapp_id%3D79%26w3_id%3Dl84164271%26fid%3D1437102214%26type%3D1%26gid%3D3300887\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E深入理解浏览器跨域原理(演示程序).rar\u003C\u002Fa\u003E( 1.38 MB, 0 downs )\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fbbs.huaweicloud.com\u002Fblogs%3Futm_source%3Dzhihu%26utm_medium%3Dblog-article%26utm_campaign%3Dblog-article\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E点击关注，第一时间了解华为云新鲜技术~\u003C\u002Fa\u003E\u003C\u002Fb\u003E\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19552572","type":"topic","id":"19552572","name":"网页浏览器"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19612046","type":"topic","id":"19612046","name":"跨域"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19550901","type":"topic","id":"19550901","name":"前端开发"}],"voteupCount":10,"voting":0,"column":{"description":"程序员的自由讨论空间，关于技术、生活和社会","canManage":false,"intro":"欢迎投稿、交流","isFollowing":false,"urlToken":"c_1016019161834774528","id":"c_1016019161834774528","articlesCount":862,"acceptSubmission":true,"title":"程序员之家","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1016019161834774528","commentPermission":"all","created":1535017844,"updated":1599158324,"imageUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-dd3b579214bf8adfb9c0b7e7defb8dda_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de.jpg?source=172ae18b","uid":"984835495964078080","userType":"organization","isFollowing":false,"urlToken":"hua-wei-yun-ji-zhu-zhai-ji-di","id":"a97ebcb387aaf4dec46f5179b8a71ec9","description":"华为云开发者社区，提供全面深入的云计算前景分析、丰富的技术干货、程序样例，分享华为云前沿资讯动态，方便开发者快速成长与发展，欢迎提问、互动，多方位了解云计算！","name":"华为云开发者社区","isAdvertiser":false,"headline":"来自华为云的新鲜技术分享","gender":1,"url":"\u002Forg\u002Fa97ebcb387aaf4dec46f5179b8a71ec9","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b","isOrg":true,"type":"people"},"followers":5822,"type":"column"},"commentCount":0,"contributions":[{"id":24970254,"state":"accepted","type":"first_publish","column":{"description":"程序员的自由讨论空间，关于技术、生活和社会","canManage":false,"intro":"欢迎投稿、交流","isFollowing":false,"urlToken":"c_1016019161834774528","id":"c_1016019161834774528","articlesCount":862,"acceptSubmission":true,"title":"程序员之家","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1016019161834774528","commentPermission":"all","created":1535017844,"updated":1599158324,"imageUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-dd3b579214bf8adfb9c0b7e7defb8dda_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de.jpg?source=172ae18b","uid":"984835495964078080","userType":"organization","isFollowing":false,"urlToken":"hua-wei-yun-ji-zhu-zhai-ji-di","id":"a97ebcb387aaf4dec46f5179b8a71ec9","description":"华为云开发者社区，提供全面深入的云计算前景分析、丰富的技术干货、程序样例，分享华为云前沿资讯动态，方便开发者快速成长与发展，欢迎提问、互动，多方位了解云计算！","name":"华为云开发者社区","isAdvertiser":false,"headline":"来自华为云的新鲜技术分享","gender":1,"url":"\u002Forg\u002Fa97ebcb387aaf4dec46f5179b8a71ec9","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b","isOrg":true,"type":"people"},"followers":5822,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"isNormal":true,"status":0,"shareText":"详解浏览器跨域的几种方法 - 来自知乎专栏「程序员之家」，作者: 华为云开发者社区 https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F159060398 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":1,"visibleOnlyToAuthor":false,"hasColumn":true,"republishers":[]}},"columns":{"c_1016019161834774528":{"description":"程序员的自由讨论空间，关于技术、生活和社会","canManage":false,"intro":"欢迎投稿、交流","isFollowing":false,"urlToken":"c_1016019161834774528","id":"c_1016019161834774528","articlesCount":862,"acceptSubmission":true,"title":"程序员之家","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1016019161834774528","commentPermission":"all","created":1535017844,"updated":1599158324,"imageUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-dd3b579214bf8adfb9c0b7e7defb8dda_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de.jpg?source=172ae18b","uid":"984835495964078080","userType":"organization","isFollowing":false,"urlToken":"hua-wei-yun-ji-zhu-zhai-ji-di","id":"a97ebcb387aaf4dec46f5179b8a71ec9","description":"华为云开发者社区，提供全面深入的云计算前景分析、丰富的技术干货、程序样例，分享华为云前沿资讯动态，方便开发者快速成长与发展，欢迎提问、互动，多方位了解云计算！","name":"华为云开发者社区","isAdvertiser":false,"headline":"来自华为云的新鲜技术分享","gender":1,"url":"\u002Forg\u002Fa97ebcb387aaf4dec46f5179b8a71ec9","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-31e47f21cb0d425f7dfdf801537157de_l.jpg?source=172ae18b","isOrg":true,"type":"people"},"followers":5822,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"clubs":{},"clubTags":{}},"currentUser":"","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false}},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{}},"env":{"ab":{"config":{"experiments":[{"expId":"launch-qa_cl_guest-2","expPrefix":"qa_cl_guest","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_foltopic_user-10","expPrefix":"us_foltopic_user","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_bullet_second-2","expPrefix":"vd_bullet_second","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_profile_video-11","expPrefix":"vd_profile_video","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_sharpness-3","expPrefix":"vd_sharpness","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_timeguide-2","expPrefix":"vd_timeguide","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_video_replay-3","expPrefix":"vd_video_replay","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_zvideo_link-10","expPrefix":"vd_zvideo_link","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"vd_bullet_gui-4","expPrefix":"vd_bullet_gui","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false}],"params":[{"id":"qap_question_visitor","type":"String","value":" 0","chainId":"_all_","layerId":"qapqa_layer_2"},{"id":"ge_spe_rt","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_742","key":2970},{"id":"se_col_boost","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_11"},{"id":"top_test_4_liguangyi","type":"String","value":"1","chainId":"_all_","layerId":"iosus_layer_1"},{"id":"li_vip_verti_search","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_2"},{"id":"gue_q_intercept","type":"String","value":"0","layerId":"gueqa_layer_2"},{"id":"gue_push2follow","type":"String","value":"1","layerId":"gueqa_layer_3"},{"id":"gue_messrec","type":"String","value":"0","layerId":"gueqa_layer_769"},{"id":"gue_sharp","type":"String","value":"1","layerId":"guevd_layer_686"},{"id":"se_club_ui","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_581"},{"id":"gue_v_serial","type":"String","value":"1","layerId":"guevd_layer_695"},{"id":"gue_art_sani","type":"String","value":"0","layerId":"gueqa_layer_647"},{"id":"web_answer_list_ad","type":"String","value":"1","layerId":"webqa_layer_4"},{"id":"web_img_up","type":"String","value":"0","layerId":"webqa_layer_862"},{"id":"gue_zvideo_link","type":"String","value":"1","layerId":"guevd_layer_2"},{"id":"qap_question_author","type":"String","value":"0","chainId":"_all_","layerId":"qapqa_layer_2"},{"id":"zr_slotpaidexp","type":"String","value":"1","chainId":"_all_","layerId":"zrrec_layer_5"},{"id":"gue_repost","type":"String","value":"0","layerId":"gueqa_layer_671"},{"id":"web_pcleft","type":"String","value":"0","layerId":"webtop_layer_701"},{"id":"gue_video_guide","type":"String","value":"1","layerId":"guevd_layer_625"},{"id":"gue_bulletmb","type":"String","value":"0","layerId":"guevd_layer_812"},{"id":"ge_club_ai","type":"String","value":"0","chainId":"_gene_","layerId":"getp_layer_882","key":2950},{"id":"tp_contents","type":"String","value":"2","chainId":"_all_","layerId":"tptp_layer_627"},{"id":"gue_goods_card","type":"String","value":"0","layerId":"gueqa_layer_1"},{"id":"gue_cdzixun","type":"String","value":"0","layerId":"gueqa_layer_3"},{"id":"ge_ge02","type":"String","value":"6","chainId":"_gene_","layerId":"gese_layer_742","key":2599},{"id":"ge_guess","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_938","key":2912},{"id":"pf_noti_entry_num","type":"String","value":"0","chainId":"_all_","layerId":"pfus_layer_718"},{"id":"web_unfriendly_comm","type":"String","value":"0","layerId":"webre_layer_1"},{"id":"web_creator_route","type":"String","value":"1","layerId":"webtop_layer_1"},{"id":"ge_upload","type":"String","value":"0","chainId":"_gene_","layerId":"geus_layer_839","key":2892},{"id":"zr_slot_training","type":"String","value":"1","chainId":"_all_","layerId":"zrrec_layer_1"},{"id":"zr_rec_answer_cp","type":"String","value":"open","chainId":"_all_","layerId":"zrrec_layer_2"},{"id":"web_login","type":"String","value":"0","layerId":"webgw_layer_759"},{"id":"web_scl_rec","type":"String","value":"0","layerId":"webgw_layer_759"},{"id":"li_paid_answer_exp","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_3"},{"id":"li_edu_page","type":"String","value":"old","chainId":"_all_","layerId":"lili_layer_580"},{"id":"web_audit_01","type":"String","value":"case1","layerId":"webre_layer_1"},{"id":"ge_relation2","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_815","key":2796},{"id":"ge_club_feed","type":"String","value":"0","chainId":"_gene_","layerId":"getp_layer_882","key":2882},{"id":"tp_dingyue_video","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_4"},{"id":"web_sem_ab","type":"String","value":"1","layerId":"webgw_layer_3"},{"id":"li_viptab_name","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_0"},{"id":"gue_fo_recom","type":"String","value":"0","layerId":"gueqa_layer_780"},{"id":"gue_recmess","type":"String","value":"0","layerId":"gueqa_layer_795"},{"id":"gue_card_test","type":"String","value":"1","layerId":"gueqa_layer_2"},{"id":"qap_labeltype","type":"String","value":"1","chainId":"_all_","layerId":"qapqa_layer_1"},{"id":"zr_expslotpaid","type":"String","value":"1","chainId":"_all_","layerId":"zrrec_layer_11"},{"id":"pf_fuceng","type":"String","value":"1","chainId":"_all_","layerId":"pfus_layer_2"},{"id":"se_college","type":"String","value":"default","chainId":"_all_","layerId":"sese_layer_2"},{"id":"pf_adjust","type":"String","value":"0","chainId":"_all_","layerId":"pfus_layer_9"},{"id":"li_svip_tab_search","type":"String","value":"1","chainId":"_all_","layerId":"lili_layer_1"},{"id":"li_panswer_topic","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_602"},{"id":"ge_ge01","type":"String","value":"5","chainId":"_gene_","layerId":"gese_layer_742","key":2597},{"id":"ug_newtag","type":"String","value":"1","chainId":"_all_","layerId":"ugus_layer_4"},{"id":"web_qxd_pc","type":"String","value":"0","layerId":"webqa_layer_929"},{"id":"ge_flow_ai","type":"String","value":"0","chainId":"_gene_","layerId":"getp_layer_872","key":2872},{"id":"ug_follow_topic_1","type":"String","value":"2","chainId":"_all_","layerId":"ugus_layer_3"},{"id":"web_heifetz_grow_ad","type":"String","value":"1","layerId":"webgw_layer_3"},{"id":"li_video_section","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_7"},{"id":"gue_article_sicon","type":"String","value":"0","layerId":"gueqa_layer_647"},{"id":"web_collection_guest","type":"String","value":"1","layerId":"webqa_layer_4"},{"id":"gue_art_ui","type":"String","value":"0","layerId":"gueqa_layer_671"},{"id":"web_answerlist_ad","type":"String","value":"0","layerId":"webqa_layer_1"},{"id":"ls_video_commercial","type":"String","value":"0","chainId":"_all_","layerId":"lsvd_layer_7"},{"id":"ge_ym_xjym","type":"String","value":"0","chainId":"_gene_","layerId":"geli_layer_856","key":2919},{"id":"ge_return","type":"String","value":"1","chainId":"_gene_","layerId":"gese_layer_788","key":2856},{"id":"ge_v_rank_v2","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_904","key":2904},{"id":"gue_video_replay","type":"String","value":"2","layerId":"guevd_layer_3"},{"id":"ge_infinity6","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_815","key":2817},{"id":"pf_creator_card","type":"String","value":"1","chainId":"_all_","layerId":"pfus_layer_1"},{"id":"li_sp_mqbk","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_748"},{"id":"web_column_auto_invite","type":"String","value":"0","layerId":"webqa_layer_1"},{"id":"gue_repost1","type":"String","value":"1","layerId":"guere_layer_819"},{"id":"ge_item","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_742","key":2971},{"id":"li_pl_xj","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_580"},{"id":"gue_self_censoring","type":"String","value":"1","layerId":"gueqa_layer_1"},{"id":"se_colorfultab","type":"String","value":"1","chainId":"_all_","layerId":"sese_layer_2"},{"id":"li_ebook_gen_search","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_10"},{"id":"ge_vip_cont2","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_858","key":2967},{"id":"se_topicfeed","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_12"},{"id":"ge_sug_dnn","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_834","key":2878},{"id":"ge_com_sup","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_859","key":2891},{"id":"tp_discover","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_3"},{"id":"pf_foltopic_usernum","type":"String","value":"50","chainId":"_all_","layerId":"pfus_layer_5"},{"id":"tp_clubhyb","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_619"},{"id":"pf_newguide_vertical","type":"String","value":"0","chainId":"_all_","layerId":"pfus_layer_4"},{"id":"li_yxzl_new_style_a","type":"String","value":"1","chainId":"_all_","layerId":"lili_layer_607"},{"id":"ge_v062","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_858","key":2863},{"id":"se_whitelist","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_2"},{"id":"ge_qnfd","type":"String","value":"1","chainId":"_gene_","layerId":"getp_layer_872","key":2858},{"id":"ge_newyanzhi","type":"String","value":"0","chainId":"_gene_","layerId":"geus_layer_839","key":2788},{"id":"li_svip_cardshow","type":"String","value":"1","chainId":"_all_","layerId":"lili_layer_0"},{"id":"gue_visit_n_artcard","type":"String","value":"1","layerId":"gueqa_layer_579"},{"id":"se_ffzx_jushen1","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_4"},{"id":"ge_club_pin","type":"String","value":"1","chainId":"_gene_","layerId":"getp_layer_881","key":2775},{"id":"pf_profile2_tab","type":"String","value":"0","chainId":"_all_","layerId":"pfus_layer_601"},{"id":"web_table","type":"String","value":"0","layerId":"webqa_layer_862"},{"id":"zw_sameq_sorce","type":"String","value":"999","chainId":"_all_","layerId":"zwqa_layer_2"},{"id":"tp_topic_tab","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_1"},{"id":"tsp_hotlist_ui","type":"String","value":"1","chainId":"_all_","layerId":"tsptop_layer_1"},{"id":"tp_fenqu_wei","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_626"},{"id":"gue_q_share","type":"String","value":"0","layerId":"gueqa_layer_647"},{"id":"zr_intervene","type":"String","value":"0","chainId":"_all_","layerId":"zrrec_layer_2"},{"id":"zr_sim3","type":"String","value":"0","chainId":"_all_","layerId":"zrrec_layer_756"},{"id":"se_entity22","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_26"},{"id":"li_catalog_card","type":"String","value":"1","chainId":"_all_","layerId":"lili_layer_11"},{"id":"se_usercard","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_581"},{"id":"gue_vid_tab","type":"String","value":"0","layerId":"guevd_layer_900"},{"id":"web_ad_banner","type":"String","value":"0","layerId":"webgw_layer_3"},{"id":"ge_jqyd1","type":"String","value":"0","chainId":"_gene_","layerId":"getp_layer_936","key":2930},{"id":"tp_zrec","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_619"},{"id":"ge_video","type":"String","value":"0","chainId":"_gene_","layerId":"geli_layer_856","key":2831},{"id":"ge_qngz1","type":"String","value":"1","chainId":"_gene_","layerId":"getp_layer_827","key":2797},{"id":"gue_bullet_second","type":"String","value":"1","layerId":"guevd_layer_1"},{"id":"ge_ltr_v1","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_904","key":2873},{"id":"gue_bullet_guide","type":"String","value":"点我，做第一个上屏的人","layerId":"guevd_layer_0"},{"id":"gue_zvideo_title","type":"String","value":"0","layerId":"guevd_layer_559"},{"id":"ge_v_rank_v3","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_742","key":2966},{"id":"ge_search_ui","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_838","key":2898},{"id":"ge_rm_d2q","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_859","key":2834},{"id":"se_guess","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_623"},{"id":"tp_topic_style","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_4"},{"id":"gue_profile_video","type":"String","value":"1","layerId":"guevd_layer_5"},{"id":"li_car_meta","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_0"},{"id":"li_topics_search","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_0"},{"id":"gue_art2qa","type":"String","value":"0","layerId":"gueqa_layer_579"},{"id":"gue_share_icon","type":"String","value":"0","layerId":"gueqa_layer_647"},{"id":"ge_usercard1","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_742","key":2740},{"id":"tp_topic_tab_new","type":"String","value":"0-0-0","chainId":"_all_","layerId":"tptp_layer_3"}],"chains":[{"chainId":"_all_"}],"encodedParams":"CjqaC4YLJwpgC0wL7ApCCyUKOAtnCygLWAsBC5sLlws+C0sLLwsqC+QK1wpyCw8L7Qo5C5YLUgsSC7QKEh0AAAYAAAAABQAAAQAAAAAAAAABAAEAAAEAAAAAAA=="},"triggers":{}},"userAgent":{"Edge":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F85.0.4183.121 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F159060398","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F159060398","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":true,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"baiduSearch":true,"googleSearch":false,"miniProgram":false,"xiaomi":false},"theme":"light","enableShortcut":true,"referer":"https:\u002F\u002Fwww.baidu.com\u002Flink?url=zVpRl7Irt88YKJjV7oC4QyXTJCkrDWbUjJeDKFA2TjHwAA4q5gDUMdQAV1JQId4c&wd=&eqid=f34d2e4b00004338000000065f6db884","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"广州","countryName":"中国","regionName":"广东","countryCode":"CN"},"logged":false},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"active":{"sendDigitsError":null,"activeConfirmSucceeded":null,"activeConfirmError":null},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}},"mcn":{},"applyStatus":{},"videoSupport":{}},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"concernedUpvoters":{},"simpleConcernedUpvoters":{},"paidContent":{},"settings":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"room":{"meta":{},"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotListCategories":[],"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"c_1016019161834774528"]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[],"contributionInvitation":null},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0},"visible":false}},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{}},"zvideos":{"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"club":{}},"republish":{}},"fetchHost":"www.zhihu.com","subAppName":"column"}</script><script src="./详解浏览器跨域的几种方法 - 知乎_files/vendor.e12a1c01608537280a5b.js.下载"></script><script src="./详解浏览器跨域的几种方法 - 知乎_files/column.app.20244583b7aeff269151.js.下载"></script><script src="./详解浏览器跨域的几种方法 - 知乎_files/hm.js.下载" async=""></script><script src="./详解浏览器跨域的几种方法 - 知乎_files/zap.js.下载"></script><script src="./详解浏览器跨域的几种方法 - 知乎_files/push.js.下载"></script><div><div style="display: none;">想来知乎工作？请发送邮件到 jobs@zhihu.com</div></div><div><div><div class="css-8pdeid"></div></div></div><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete12-0" id="Popover11-toggle" aria-haspopup="true" aria-owns="Popover11-content" class="Input" placeholder="选择语言" value=""><svg class="Zi Zi--Select" fill="#afbdcf" viewBox="0 0 24 24" width="24" height="24"><path d="M12 16.183l2.716-2.966a.757.757 0 0 1 1.064.001.738.738 0 0 1 0 1.052l-3.247 3.512a.758.758 0 0 1-1.064 0L8.22 14.27a.738.738 0 0 1 0-1.052.758.758 0 0 1 1.063 0L12 16.183zm0-9.365L9.284 9.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l3.248-3.512a.758.758 0 0 1 1.065 0L15.78 8.73a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063.001L12 6.818z" fill-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>